---
title: "homework"
author: "Rongkang Xiong"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{homework}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(StatComp21049)
```

## The homework 0 2021---09---16

### Question

texts. The 1st example figures. The 2nd example tables. The 3rd example

### Answer

### Example 1

1.italics斜体 *This txt will apper italicized!*

2.old加粗 **This txt will apper italicized!**

3.Headings 标题 \#\# This is a secondary heading 二级标题 \#\#\# This is
a tertiary heading 小标题

4.Unordered Lists 无序数据列 - first item in list - second item in list
- third item in list

5.Ordered Lists 有序数据列 1. first item in list 2. second item in list
3. third item in list

6.Links超链接 [Johns Hopkin Bloomberg School of Public
Health](http://www.jhsph.edu/) Download R

7.Advanced Linking 超链接 I spend so much time reading [R bloggers][1]
and [Simply Statistics][2]! [1]: <http://www.r-bloggers.com/> "R
bloggers" [2]: <http://simplystatistics.org/> "Simply Statistics"

8.Newlines 换行 换行需要在句尾加上双空格

```{r}
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6), type = "n")
text(x = 3, y = 3, labels = "R for beginner")
```

```{r}
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6), type = "n")
text(x = c(3, 3), y = c(5,3), labels = c("R for beginner", "It's easy to learn"))
```

### Example 2

type = "p": 绘制点，默认值\
type = "l": 绘制线\
type = "b": 同时绘制点和线\
type = "c": 仅绘制参数"b"所示的线\
type = "o": 同时绘制点和线，且线穿过点\
type = "h": 绘制出点到横坐标轴的垂直线\
type = "s": 绘制出阶梯图（先横后纵）\
type = "S": 绘制出阶梯图（先纵后竖）\
type = "n": 作空图

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="p",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="l",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="b",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="c",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="o",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="h",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="s",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="S",xlim = c(0,7),ylim = c(0,7))
```

```{r}
x<- c(1:6)
y<- c(1:6)
plot(x,y,main="test",type="n",xlim = c(0,7),ylim = c(0,7))
```

### Example 3

绘制表格

|  姓名  | 学科 | 分数 |
|:------:|:----:|:----:|
|  张三  | 英语 |  80  |
|  李四  | 语文 |  70  |
| 刘老师 | 物理 |  60  |

```{r pressure,echo=FALSE}
x<-c(1,2,3)
y<-c(2,3,5)
table(x,y)
```

------------------------------------------------------------------------


## The homework 1 2021-09-23

### Question

Exercises 3.4, 3.11,3.20(page 94-96,Statistical Computating with R).

### Answer

#### 3.4:

The Rayleigh density [156, Ch. 18] is $$
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma>0
$$ Develop an algorithm to generate random samples from a Rayleigh(σ)
distribution. Generate Rayleigh(σ) samples for several choices of σ \> 0
and check that the mode of the generated samples is close to the
theoretical mode σ (check the histogram).

解： 取 $\sigma=0.1$

```{r}
rm(list=ls())
0.1->sigma;1e5->n;k<-1;numeric(n)->x
while (k<n) {
  runif(1)->u
  x[k]<-sqrt(2*log(1/u))*sigma; #广义均匀分布和单位均匀分布
  k+1->k
}
hist(x,prob=TRUE,main=expression(f(y)==x/(sigma^2)*exp(-x^2/(2*sigma^2))))
t<-seq(0,0.5,0.01)
lines(t,t/(sigma^2)*exp(-t^2/(2*sigma^2)))
```

取 $\sigma=1$

```{r}
rm(list=ls())
1->sigma;1e5->n;k<-1;numeric(n)->x
while (k<n) {
  runif(1)->u
  x[k]<-sqrt(2*log(1/u))*sigma; #广义均匀分布和单位均匀分布
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(y)==x/(sigma^2)*exp(-x^2/(2*sigma^2))))
t<-seq(0,6,0.01)
lines(t,t/(sigma^2)*exp(-t^2/(2*sigma^2)))
```

取 $\sigma=10$

```{r}
rm(list=ls())
10->sigma;1e5->n;k<-1;numeric(n)->x
while (k<n) {
  runif(1)->u
  x[k]<-sqrt(2*log(1/u))*sigma; #广义均匀分布和单位均匀分布
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(y)==x/(sigma^2)*exp(-x^2/(2*sigma^2)),sigma==1))
t<-seq(0,40,0.01)
lines(t,t/(sigma^2)*exp(-t^2/(2*sigma^2)))
```
#### 3.11:

Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have $N(0, 1)$ and $N(3, 1)$ distributions
with mixing probabilities $p_1$ and $p_2 = 1 − p_1$. Graph the histogram
of the sample with density superimposed, for $p_1 = 0.75$. Repeat with
different values for $p_1$ and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures.

解：

```{r}
rm(list=ls())
p<-0.75
n<-1e3;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k+1->k
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.6
n<-1e3;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k+1->k
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.55
n<-1e3
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k+1->k
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.5
n<-1e4;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.45
n<-1e3;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.4
n<-1e3;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))

```

```{r}
rm(list=ls())
p<-0.35
n<-1e3;
x1<-rnorm(n,0,1)
x2<-rnorm(n,3,1)
x<-numeric(n)
k=1
while(k<n){
  u<-runif(1)
  if (u<=p) x[k]<-x1[k] else x[k]<-x2[k]
  k <- k+1
}
hist(x,prob=TRUE,main=expression(f(x)==p*x1+(1-p)*x2))
```

所以$P\in (0.45-0.55)$左右时，会产生双峰分布




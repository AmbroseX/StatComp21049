<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="StatComp21049">
<title>homework • StatComp21049</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="homework">
<meta property="og:description" content="StatComp21049">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">StatComp21049</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/homework.html">homework</a>
    <a class="dropdown-item" href="../articles/intro.html">intro</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>homework</h1>
                        <h4 data-toc-skip class="author">Rongkang Xiong</h4>
            
      
      
      <div class="d-none name"><code>homework.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">StatComp21049</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="the-homework-0-20210916">The homework 0 2021—09—16<a class="anchor" aria-label="anchor" href="#the-homework-0-20210916"></a>
</h2>
<div class="section level3">
<h3 id="question">Question<a class="anchor" aria-label="anchor" href="#question"></a>
</h3>
<p>texts. The 1st example figures. The 2nd example tables. The 3rd example</p>
</div>
<div class="section level3">
<h3 id="answer">Answer<a class="anchor" aria-label="anchor" href="#answer"></a>
</h3>
</div>
<div class="section level3">
<h3 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>1.italics斜体 <em>This txt will apper italicized!</em></p>
<p>2.old加粗 <strong>This txt will apper italicized!</strong></p>
<p>3.Headings 标题 ## This is a secondary heading 二级标题 ### This is a tertiary heading 小标题</p>
<p>4.Unordered Lists 无序数据列 - first item in list - second item in list - third item in list</p>
<p>5.Ordered Lists 有序数据列 1. first item in list 2. second item in list 3. third item in list</p>
<p>6.Links超链接 <a href="http://www.jhsph.edu/" class="external-link">Johns Hopkin Bloomberg School of Public Health</a> Download R</p>
<p>7.Advanced Linking 超链接 I spend so much time reading [R bloggers][1] and [Simply Statistics][2]! [1]: <a href="http://www.r-bloggers.com/" class="external-link uri">http://www.r-bloggers.com/</a> “R bloggers” [2]: <a href="http://simplystatistics.org/" class="external-link uri">http://simplystatistics.org/</a> “Simply Statistics”</p>
<p>8.Newlines 换行 换行需要在句尾加上双空格</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span>, labels <span class="op">=</span> <span class="st">"R for beginner"</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R for beginner"</span>, <span class="st">"It's easy to learn"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>type = “p”: 绘制点，默认值<br>
type = “l”: 绘制线<br>
type = “b”: 同时绘制点和线<br>
type = “c”: 仅绘制参数“b”所示的线<br>
type = “o”: 同时绘制点和线，且线穿过点<br>
type = “h”: 绘制出点到横坐标轴的垂直线<br>
type = “s”: 绘制出阶梯图（先横后纵）<br>
type = “S”: 绘制出阶梯图（先纵后竖）<br>
type = “n”: 作空图</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"p"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"l"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"b"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"c"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"o"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"h"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"s"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"S"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,main<span class="op">=</span><span class="st">"test"</span>,type<span class="op">=</span><span class="st">"n"</span>,xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h3>
<p>绘制表格</p>
<table class="table">
<thead><tr class="header">
<th align="center">姓名</th>
<th align="center">学科</th>
<th align="center">分数</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">张三</td>
<td align="center">英语</td>
<td align="center">80</td>
</tr>
<tr class="even">
<td align="center">李四</td>
<td align="center">语文</td>
<td align="center">70</td>
</tr>
<tr class="odd">
<td align="center">刘老师</td>
<td align="center">物理</td>
<td align="center">60</td>
</tr>
</tbody>
</table>
<pre><code><span class="co">#&gt;    y</span>
<span class="co">#&gt; x   2 3 5</span>
<span class="co">#&gt;   1 1 0 0</span>
<span class="co">#&gt;   2 0 1 0</span>
<span class="co">#&gt;   3 0 0 1</span></code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-1-2021-09-23">The homework 1 2021-09-23<a class="anchor" aria-label="anchor" href="#the-homework-1-2021-09-23"></a>
</h2>
<div class="section level3">
<h3 id="question-1">Question<a class="anchor" aria-label="anchor" href="#question-1"></a>
</h3>
<p>Exercises 3.4, 3.11,3.20(page 94-96,Statistical Computating with R).</p>
</div>
<div class="section level3">
<h3 id="answer-1">Answer<a class="anchor" aria-label="anchor" href="#answer-1"></a>
</h3>
<div class="section level4">
<h4 id="section">3.4:<a class="anchor" aria-label="anchor" href="#section"></a>
</h4>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0
\]</span> Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
<p>解： 取 <span class="math inline">\(\sigma=0.1\)</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fl">0.1</span><span class="op">-&gt;</span><span class="va">sigma</span>;<span class="fl">1e5</span><span class="op">-&gt;</span><span class="va">n</span>;<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>;<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">x</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">u</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">u</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">sigma</span>; <span class="co">#骞夸箟鍧囧寑鍒嗗竷鍜屽崟浣嶅潎鍖€鍒嗗竷</span>NA<span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">==</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">t</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>取 <span class="math inline">\(\sigma=1\)</span></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fl">1</span><span class="op">-&gt;</span><span class="va">sigma</span>;<span class="fl">1e5</span><span class="op">-&gt;</span><span class="va">n</span>;<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>;<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">x</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">u</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">u</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">sigma</span>; <span class="co">#骞夸箟鍧囧寑鍒嗗竷鍜屽崟浣嶅潎鍖€鍒嗗竷</span>NA<span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">==</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span>,<span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">t</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>取 <span class="math inline">\(\sigma=10\)</span></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fl">10</span><span class="op">-&gt;</span><span class="va">sigma</span>;<span class="fl">1e5</span><span class="op">-&gt;</span><span class="va">n</span>;<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>;<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">x</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">u</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">u</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">sigma</span>; <span class="co">#骞夸箟鍧囧寑鍒嗗竷鍜屽崟浣嶅潎鍖€鍒嗗竷</span>NA<span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">==</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="va">sigma</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">40</span>,<span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">t</span><span class="op">/</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-15-1.png" width="700"> #### 3.11:</p>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0, 1)\)</span> and <span class="math inline">\(N(3, 1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
<p>解：</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.75</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.6</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.55</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.5</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e4</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.45</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.4</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="fl">0.35</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>;
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">=</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">u</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">u</span><span class="op">&lt;=</span><span class="va">p</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="kw">else</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>,prob<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="va">p</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>所以<span class="math inline">\(P\in (0.45-0.55)\)</span>左右时，会产生双峰分布</p>
</div>
<div class="section level4">
<h4 id="section-1">3.20:<a class="anchor" aria-label="anchor" href="#section-1"></a>
</h4>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t ≥ 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t) =\sum_{i=1}^{N(t)} Yi, t ≥ 0, where \{N(t), t ≥ 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1, Y_2,...\)</span>are <span class="math inline">\(iid\)</span> and independent of <span class="math inline">\(\{N(t), t ≥ 0\}.\)</span> Write a program to simulate a compound <span class="math inline">\(Poisson(λ)–Gamma \ process (Y \ has \ a \ Gamma\  distribution)\)</span>. Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values. Hint: Show that<span class="math inline">\(E[X(t)] = λtE[Y1]\)</span> and<span class="math inline">\(Var(X(t)) = λtE[Y_1^{2}]\)</span>.</p>
<p>解：<br><span class="math inline">\({Y_i}\)</span>是Gamma分布，<span class="math inline">\(N(t)\)</span>是泊松过程<br>
In R, the Gamma distribution with parameters <span class="math inline">\(shape = a\)</span> and <span class="math inline">\(scale = s\)</span> has density <span class="math display">\[f(x)= \frac{1}{s^a\Gamma(a)} x^{a-1} e^{-x/s},\quad x\geq 0, a&gt;0,s&gt;0\]</span> You can use “rgamma(n,shape=a,scale=s)” to generate n gamma random numbers.</p>
<p><span class="math display">\[E[X]=\frac{\alpha}{\lambda}=as, \quad \operatorname{Var}(X)=\frac{\alpha}{\lambda^{2}}=as^2 \\
(E[X])^2 = a^2s^2, \quad E[X^2]= Var(X)+(E(X))^2=as^2+a^2s^2
\]</span></p>
<p>泊松分布 <span class="math display">\[P(X=k)=\frac{\lambda^k}{k!}e^{-\lambda},\quad k=0,1,...\]</span> 泊松过程 <span class="math display">\[P(X(t)=k)=\frac{(\lambda t)^k}{k!}e^{-\lambda t},\quad k=0,1,...\]</span> You can use “rpois(n,lambda)” to generate n Poison random numbers.<br>
1) Generate n Poison distribution random numbers. 2) Generate n Gamma distribution random numbers. 3) 根据泊松分布的值Np(t)，对Y的前Np项进行求和作为X(t)的值</p>
<p>画出<span class="math inline">\(Poisson(\lambda)-gamma\ process\)</span></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e3</span>
<span class="va">Npoison</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;=</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">Npoison</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lambda.poison</span><span class="op">*</span><span class="va">k</span><span class="op">)</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">k</span><span class="op">+</span><span class="fl">1</span>
<span class="op">}</span>
<span class="va">maxp</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Npoison</span><span class="op">)</span>
<span class="va">Y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">maxp</span>,shape <span class="op">=</span> <span class="va">a</span>,scale <span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">)</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;=</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Npoison</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="homework_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>(1)对<span class="math inline">\(X(10)\)</span>进行模拟计算</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">t</span><span class="op">=</span><span class="fl">10</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e4</span>
<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;=</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">Npoison</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lambda.poison</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
  <span class="va">Y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">Npoison</span>,shape <span class="op">=</span> <span class="va">a</span>,scale <span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">)</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Npoison</span><span class="op">]</span><span class="op">)</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'E[X(10)]='</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 19.9689874276965"</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Var(X(10)='</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Var(X(10)= 40.9755736885445"</span></code></pre></div>
<p>理论计算值 <span class="math display">\[
E[X(t)]=\lambda t E[Y_1]=10\lambda a/\lambda_{gamma} \\
Var[x]=\lambda t E[Y_1^2]=10\lambda (a+a^2)/\lambda_{gamma}^2
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">Ex10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="va">a</span><span class="op">/</span><span class="va">lambda.gamma</span>
<span class="va">Var10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">^</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"E[X(10)]="</span>,<span class="va">Ex10</span>,<span class="st">",Var[X(10)]="</span>,<span class="va">Var10</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 20 ,Var[X(10)]= 40"</span></code></pre></div>
<p>(2)对<span class="math inline">\(X(10)\)</span>进行模拟计算</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">t</span><span class="op">=</span><span class="fl">10</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e4</span>
<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;=</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">Npoison</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lambda.poison</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
  <span class="va">Y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">Npoison</span>,shape <span class="op">=</span> <span class="va">a</span>,scale <span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">)</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Npoison</span><span class="op">]</span><span class="op">)</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'E[X(10)]='</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 10.0104322213961"</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Var(X(10)='</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Var(X(10)= 10.0493887537351"</span></code></pre></div>
<p>理论计算值： <span class="math display">\[
E[X(t)]=\lambda t E[Y_1]=10\lambda a/\lambda_{gamma} \\
Var[x]=\lambda t E[Y_1^2]=10\lambda (a+a^2)/\lambda_{gamma}^2
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">2</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">Ex10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="va">a</span><span class="op">/</span><span class="va">lambda.gamma</span>
<span class="va">Var10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">^</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"E[X(10)]="</span>,<span class="va">Ex10</span>,<span class="st">",Var[X(10)]="</span>,<span class="va">Var10</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 10 ,Var[X(10)]= 10"</span></code></pre></div>
<p>(3)对<span class="math inline">\(X(10)\)</span>进行模拟计算</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">5</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">4</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">2</span>
<span class="va">t</span><span class="op">=</span><span class="fl">10</span>
<span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e4</span>
<span class="va">k</span><span class="op">&lt;-</span><span class="fl">1</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="kw">while</span><span class="op">(</span><span class="va">k</span><span class="op">&lt;=</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">Npoison</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">lambda.poison</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
  <span class="va">Y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">Npoison</span>,shape <span class="op">=</span> <span class="va">a</span>,scale <span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">)</span>
  <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">Npoison</span><span class="op">]</span><span class="op">)</span>
  <span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">-&gt;</span><span class="va">k</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'E[X(10)]='</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="st">'Var(X(10)='</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 24.967313500404 Var(X(10)= 18.6365123640225"</span></code></pre></div>
<p>理论计算值： <span class="math display">\[
E[X(t)]=\lambda t E[Y_1]=10\lambda a/\lambda_{gamma} \\
Var[x]=\lambda t E[Y_1^2]=10\lambda (a+a^2)/\lambda_{gamma}^2
\]</span></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">lambda.poison</span><span class="op">&lt;-</span><span class="fl">5</span>
<span class="va">lambda.gamma</span><span class="op">&lt;-</span><span class="fl">4</span>
<span class="va">a</span> <span class="op">=</span> <span class="fl">2</span>
<span class="va">Ex10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="va">a</span><span class="op">/</span><span class="va">lambda.gamma</span>
<span class="va">Var10</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">*</span><span class="va">lambda.poison</span><span class="op">*</span><span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">lambda.gamma</span><span class="op">^</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"E[X(10)]="</span>,<span class="va">Ex10</span>,<span class="st">",Var[X(10)]="</span>,<span class="va">Var10</span><span class="op">)</span>
<span class="co">#&gt; [1] "E[X(10)]= 25 ,Var[X(10)]= 18.75"</span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-2-2021-09-30">The homework 2 2021-09-30<a class="anchor" aria-label="anchor" href="#the-homework-2-2021-09-30"></a>
</h2>
<div class="section level3">
<h3 id="question-2">Question<a class="anchor" aria-label="anchor" href="#question-2"></a>
</h3>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R)</p>
</div>
<div class="section level3">
<h3 id="answer-2">Answer<a class="anchor" aria-label="anchor" href="#answer-2"></a>
</h3>
<div class="section level4">
<h4 id="section-2">5.4<a class="anchor" aria-label="anchor" href="#section-2"></a>
</h4>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(\operatorname{Beta}(3,3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x=0.1,0.2, \ldots, 0.9\)</span>. Compare the estimates with the values returned by the pbeta function in <span class="math inline">\(R\)</span>.</p>
<p>解： <span class="math inline">\(Beta(x;a,b)\)</span>分布的概率密度函数为 <span class="math display">\[
f(x;a,b)=\frac{1}{B(a,b)} x^{a-1}(1-x)^{b-1}
\]</span> Beta函数定义：</p>
<p><span class="math display">\[
B(a,b)=\int_{0}^{1} t^{a-1}(1-t)^{b-1} d t
\]</span> <span class="math inline">\(pbeta\)</span>的定义： <span class="math display">\[pbeta(x,a,b) =\frac{1}{B(a,b)} \int _0^x t^{a-1}(1-t)^{b-1}dt\]</span> <span class="math display">\[
B(3, 3)=\int_{0}^{1} t^{2}(1-t)^{2} d t
\]</span> 首先我们计算<span class="math inline">\(B(3,3)\)</span>的积分估计 <span class="math display">\[
B(3,3)=\int_{0}^{1} t^{2}(1-t)^{2} d t=E[t^2(1-t)^2] , \quad t\sim U(0,1)
\]</span> 然后可以计算<span class="math inline">\(pbeta(x,3,3)\)</span>的估计 <span class="math display">\[
pbeta(x,3,3) =\frac{1}{B(3,3)} \int _0^x t^{2}(1-t)^{2}dt = \frac{x}{B(3,3)}E[t^2(1-t)^2],\quad t\sim U(0,x)
\]</span></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span><span class="op">&lt;-</span><span class="fl">1e4</span>;<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>,min<span class="op">=</span><span class="fl">0</span>,max<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">theta.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">theta.hat</span>
<span class="va">result</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Beta(3,3)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Estimate"</span>, <span class="st">"Theoretical"</span><span class="op">)</span>
<span class="va">result</span>
<span class="co">#&gt;             Estimate Theoretical</span>
<span class="co">#&gt; Beta(3,3) 0.03340309  0.03333333</span></code></pre></div>
<p>编写求cdf的函数：</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">pbetaCDF</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">pbetax</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
  <span class="va">m</span><span class="op">&lt;-</span><span class="fl">1e6</span>;
  <span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>,min<span class="op">=</span><span class="fl">0</span>,max<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">Beta_a_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">^</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">n</span><span class="op">&lt;-</span><span class="fl">1e6</span>;
    <span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,min<span class="op">=</span><span class="fl">0</span>,max <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">Beta_x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">^</span><span class="op">(</span><span class="va">a</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="va">pbetax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Beta_x</span><span class="op">/</span><span class="va">Beta_a_b</span>
    <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pbetax</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="fu">pbetaCDF</span><span class="op">(</span><span class="va">x</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt;  [1] 0.008557496 0.057888829 0.163017738 0.317519440 0.499801124 0.682542079</span>
<span class="co">#&gt;  [7] 0.836513134 0.942156036 0.992122415 1.001122174</span></code></pre></div>
<p>比较自定义函数和pbeta函数</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>
<span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="va">x</span>
<span class="va">result</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu">pbetaCDF</span><span class="op">(</span><span class="va">x</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">pbeta</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"pbetaCDF(3,3)"</span>,<span class="st">"pbeta(x,3,3)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">result</span>
<span class="co">#&gt;                       0.1        0.2       0.3       0.4       0.5      0.6</span>
<span class="co">#&gt; x             0.100000000 0.20000000 0.3000000 0.4000000 0.5000000 0.600000</span>
<span class="co">#&gt; pbetaCDF(3,3) 0.008550927 0.05788951 0.1628465 0.3168958 0.4991435 0.682009</span>
<span class="co">#&gt; pbeta(x,3,3)  0.008560000 0.05792000 0.1630800 0.3174400 0.5000000 0.682560</span>
<span class="co">#&gt;                    0.7       0.8      0.9         1</span>
<span class="co">#&gt; x             0.700000 0.8000000 0.900000 1.0000000</span>
<span class="co">#&gt; pbetaCDF(3,3) 0.836159 0.9411581 0.990621 0.9991613</span>
<span class="co">#&gt; pbeta(x,3,3)  0.836920 0.9420800 0.991440 1.0000000</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="section-3">5.9<a class="anchor" aria-label="anchor" href="#section-3"></a>
</h4>
<p>The Rayleigh density <span class="math inline">\([156,(18.76)]\)</span> is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0
\]</span> Implement a function to generate samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent <span class="math inline">\(X_{1}, X_{2} ?\)</span></p>
<p>解： <span class="math display">\[
\begin{align}
&amp; F(x) = \int_0^x \frac{t}{\sigma^{2}} e^{-t^{2} /\left(2 \sigma^{2}\right)}dt=1-e^{-x^2/{2\sigma^2}} \\
&amp; y=1-e^{-x^2/{2\sigma^2}} \\
&amp;\Rightarrow x =\sigma\sqrt{-2ln(1-y)} \\
&amp; \Rightarrow x' =\sigma\sqrt{-2ln(y)} , \quad y\in[0,1]
\end{align}
\]</span> 因此方差 <span class="math display">\[
\begin{align}
E(X) &amp;= \sigma^2\int_0^1 \sqrt{-2ln(1-y)}dy=\sqrt{\frac{\pi}{2}}\sigma \\
E(X') &amp;= \sigma^2\int_0^1 \sqrt{-2ln(y)}dy=\sqrt{\frac{\pi}{2}}\sigma \\
Var(X) &amp; = \sigma^2\int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})^2dy = (2-\frac{\pi}{2})\sigma^2\\
Var(X') &amp;= \sigma^2\int_0^1 (\sqrt{-2ln(y)}-\sqrt{\frac{\pi}{2}})^2dy =(2-\frac{\pi}{2})\sigma^2 \\
Cov(X,X') &amp;= \sigma^2 \int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})(\sqrt{-2ln(y)}-\sqrt{\frac{\pi}{2}})dy\\
Var(\frac{X+X'}{2}) &amp;= (Var(X)+Var({X'})+2Cov(X,X'))/4 \\
&amp;=1-\frac{\pi}{4}+\frac{1}{2}\sigma^2 \int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})(\sqrt{-2ln(y)}-\sqrt{\frac{\pi}{2}})dy
\end{align}
\]</span> 两个独立的随机变量的方差 <span class="math display">\[
\begin{align}
Cov(X_1,X_2) &amp;= 0 \\
Var(X_1) &amp;= Var(X_2)=\sigma^2\int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})^2dy = (2-\frac{\pi}{2})\sigma^2\\ \\
Var(\frac{X_1+X_2}{2}) &amp;=(Var(X_1)+Var(X_2))/4 = 1-\frac{\pi}{4}  \\
\end{align}
\]</span> 因此方差减小的百分比为 <span class="math display">\[
\begin{align}
Percent \ reduction &amp;=\frac{(Var_x-Var_{x'})}{Var_x}\times 100\%  \\
&amp;=\frac{2}{\pi-4}\int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})(\sqrt{-2ln(y)}-\sqrt{\frac{\pi}{2}})dy \times 100\% \\
\end{align}
\]</span> (1)求协方差积分 <span class="math display">\[
\frac{1}{\sigma^2}Cov(X,X') = \int_0^1 (\sqrt{-2ln(1-y)}-\sqrt{\frac{\pi}{2}})(\sqrt{-2ln(y)}-\sqrt{\frac{\pi}{2}})dy
\]</span></p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">&lt;-</span><span class="fl">1e5</span>;<span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="va">covx12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cov(X,X') = "</span>,<span class="va">covx12</span><span class="op">)</span></code></pre>
<p>(2)因此<span class="math inline">\(X,X'\)</span>是负相关的 我们可以模拟计算理论上方差减小百分比</p>
<pre><code>rm(list=ls())
m&lt;-1e5;y&lt;-runif(m)
covx12 &lt;- mean((sqrt(-2*log(y))-sqrt(pi/2))*(sqrt(-2*log(1-y))-sqrt(pi/2)))

result &lt;-matrix(0,5,1)
result[1,1] &lt;- 2-pi/2
result[2,1] &lt;- covx12
result[3,1] &lt;- 1-pi/4+1/2*covx12
result[4,1] &lt;- 1-pi/4
result[5,1] &lt;- paste("Percent reduction = ",2/(pi-4)*covx12*100,"%")
rownames(result) = c("Var(X) = ","Cov(X,X') = ","Var((X+X')/2) =","Var((X1+X2)/2) =","Percent reduction = ")
colnames(result) = c("理论计算值")
result</code></pre>
<p>(3)实验上方差减小百分比</p>
<pre><code>rm(list=ls())
m&lt;-1e5;y&lt;-runif(m)
y1&lt;-y[1:m/2]
x1&lt;-sqrt(-2*log(1-y1))
x2&lt;-sqrt(-2*log(y1))
covx12&lt;-mean((x1-mean(x1))*(x2-mean(x2)))
u1&lt;-(x1+x2)/2
var12 &lt;- var(u1)
x3&lt;-sqrt(-2*log(runif(m/2)))
x4&lt;-sqrt(-2*log(runif(m/2)))
var12in &lt;-var((x3+x4)/2)
result &lt;-matrix(0,6,1)
result[1,1] &lt;- var(x1)
result[2,1] &lt;- var(x2)
result[3,1] &lt;- covx12
result[4,1] &lt;- var12
result[5,1] &lt;- var12in
result[6,1] &lt;- paste((var12in-var12)/var12in*100,"%")
rownames(result) = c("Var(X) = ","Var(X') = ","Cov(X,X') = ","Var((X+X')/2) =","Var((X1+X2)/2) =","Percent reduction = ")
colnames(result) = c("  MC模拟计算值")
result</code></pre>
</div>
<div class="section level4">
<h4 id="section-4">5.13<a class="anchor" aria-label="anchor" href="#section-4"></a>
</h4>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> by importance sampling? Explain.</p>
<p>解 <span class="math display">\[
\begin{align}
\hat{\theta} &amp;=\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x \\
&amp; = \int_{1}^{\infty} \frac{g(x)}{f(x)}f(x)d x \\
&amp; = \frac{1}{m} \sum_{i=1}^m \frac{g(x_i)}{f(x_i)}
\end{align}
\]</span> 取 <span class="math display">\[
\begin{align}
&amp; let \quad f_1(x) =2exe^{-x^2} ,\quad f_2(x)=e^{-x+1} \\
&amp; F_1(x)=1-e^{1-x^2},F_2(x)=1-e^{1-x}\\
&amp; \frac{g(x)}{f_1(x)} = \frac{x}{2e\sqrt{2\pi}}e^{x^2/2} \\
&amp; \frac{g(x)}{f_2(x)} = \frac{x^2}{\sqrt{2\pi}}e^{x-x^2/2-1}\\
&amp;y_1=F_1(x_1) \Rightarrow x_1= \sqrt{1-ln(1-y_1)}=\sqrt{1-ln(y_1)}\\
&amp;y_2=F_2(x_2) \Rightarrow x_2= 1-ln(1-y_2)=1-ln(y_2)
\end{align}
\]</span></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">&lt;-</span><span class="fl">1e5</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>,min<span class="op">=</span><span class="fl">0</span>,max<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">x1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="va">x2</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">f1</span><span class="op">&lt;-</span><span class="va">x1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">(</span><span class="va">x1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">f2</span><span class="op">&lt;-</span><span class="va">x2</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x2</span><span class="op">-</span><span class="op">(</span><span class="va">x2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span>
<span class="va">result</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est"</span>,<span class="st">"sd"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f1(x)"</span>,<span class="st">"f2(x)"</span><span class="op">)</span>
<span class="va">result</span>
<span class="co">#&gt;         f1(x)     f2(x)</span>
<span class="co">#&gt; est 0.3985729 0.3985729</span>
<span class="co">#&gt; sd  0.9580855 0.1580464</span></code></pre></div>
<p>Here ‘est’ is <span class="math inline">\(\hat{\theta}\)</span> while ‘sd’ is the standard deviation of <span class="math inline">\(\frac{g(Xi )}{f (Xi )}\)</span> instead of <span class="math inline">\(\hat{\theta}\)</span> So <span class="math inline">\(f_2(x)=e^{-x+1}\)</span> produce the smaller variance in estimating.</p>
</div>
<div class="section level4">
<h4 id="section-5">5.14<a class="anchor" aria-label="anchor" href="#section-5"></a>
</h4>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> by importance sampling.</p>
<p>解： 和5.13中的方法一样，选取<span class="math inline">\(f_2(x)=e^{-x+1}\)</span> <span class="math display">\[
\begin{align}
&amp; F(x)=1-e^{1-x}\\
&amp; \frac{g(x)}{f(x)} = \frac{x^2}{\sqrt{2\pi}}e^{x-x^2/2-1}\\
&amp;y=F(x_2) \Rightarrow x= 1-ln(1-y)=1-ln(y)
\end{align}
\]</span></p>
<pre><code>rm(list=ls())
m&lt;-1e5
y&lt;-runif(m,min=0,max=1)
x&lt;-1-log(y)
f&lt;-x^2/(sqrt(2*pi))*exp(x-(x^2)/2-1)
result = matrix(0,2,1)
result[1,1] = mean(f)
result[2,1] = sd(f)
rownames(result) = c("est","sd")
colnames(result) = c("f1(x)")
result
paste("积分估计值 theta.hat = ",mean(f))</code></pre>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-3-2021-10-14">The homework 3 2021-10-14<a class="anchor" aria-label="anchor" href="#the-homework-3-2021-10-14"></a>
</h2>
<div class="section level3">
<h3 id="question-3">Question<a class="anchor" aria-label="anchor" href="#question-3"></a>
</h3>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p>
</div>
<div class="section level3">
<h3 id="answer-3">Answer<a class="anchor" aria-label="anchor" href="#answer-3"></a>
</h3>
<div class="section level4">
<h4 id="section-6">6.5<a class="anchor" aria-label="anchor" href="#section-6"></a>
</h4>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2_{2}\)</span> data with sample size n = 20.<br>
Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p>解:<br>
卡方分布密度 <span class="math display">\[
\begin{align}
\chi^2_n(x) &amp;= \frac{1}{2^{n/2}\Gamma(n/2)} x^{n/2-1} e^{-x/2} ,\quad x&gt;0 \\
E[X]  &amp; = n , \quad Var(X) = 2n \\
Z_1 \sim \chi^2_{n1},&amp;Z_2 \sim \chi^2_{n2} \Rightarrow Z_1+Z_2 \sim \chi^2_{n_1+n_2}
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp;if \quad X \sim N(0,1),Y_i \sim \chi_n^2 \quad and \quad X,Y_i \quad independent \\
&amp;\Rightarrow T=\frac{X}{\sqrt{Y_i/n}} \sim t_n \\
&amp;\Rightarrow  \sum_{i=1}^m Y_i \sim \chi_{m*n}^2 \\
&amp;\Rightarrow T=\frac{X}{\sqrt{\sum_{i=1}^m Y_i/(n*m)}} \sim t_{n*m} \\
&amp;\Rightarrow T=\frac{X}{\sqrt{\bar{Y}/n}} \sim t_{n*m} \\
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
x_1,x_2,...x_n \sim N(0,1) \\
T = \frac{\bar{X}-\mu}{S_n/\sqrt{n}} \sim t_{n-1}
\end{align}
\]</span></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">n</span><span class="op">)</span>
<span class="va">a</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Y</span>,conf.level <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'鍧囧€肩殑 95%t-interval:'</span>NA<span class="va">a</span>NA<span class="op">[</span>NA<span class="fl">4</span>NA<span class="op">]</span>NA<span class="op">)</span>NA<span class="co">#&gt; [1] "鍧囧€肩殑 95%t-interval: c(1.51947661481316, 3.53255804286008)"</span>NA<span class="va">UCL</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="va">alpha</span>,df<span class="op">=</span><span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'upper confidence limits UCL ='</span>,<span class="va">UCL</span><span class="op">)</span>
<span class="co">#&gt; [1] "upper confidence limits UCL = 8.68651431740617"</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.05</span>
<span class="va">mu0</span> <span class="op">=</span> <span class="va">n</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">m</span>, df <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
<span class="va">LCL</span> <span class="op">&lt;-</span> <span class="va">mu0</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="va">UCL</span> <span class="op">&lt;-</span> <span class="va">mu0</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'鍧囧€肩殑 95%t-interval:['</span>,<span class="va">LCL</span>C<span class="st">','</span>]<span class="va">UCL</span>NA<span class="st">']'</span>NA<span class="op">)</span>NA<span class="co">#&gt; [1] "鍧囧€肩殑 95%t-interval:[ -0.0528546848887941 , 4.05285468488879 ]"</span>NA</code></pre></div>
<p>MC实验 t-interval 包含了均值<span class="math inline">\(\mu = 2\)</span><br>
A two sides <span class="math inline">\(100(1−\alpha)\%\)</span> confidence interval of variance is given by <span class="math inline">\(\mu+\frac{S_n}{\sqrt{n}}t_{n-1}(\alpha/2),\mu+\frac{S_n}{\sqrt{n}}t_{n-1}(1-\alpha/2)\)</span></p>
</div>
<div class="section level4">
<h4 id="a">6.A<a class="anchor" aria-label="anchor" href="#a"></a>
</h4>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2_{1}\)</span> (ii) Uniform(0,2) (iii) Exponential(rate=1).<br>
In each case, test <span class="math inline">\(H_0 : \mu = \mu_0 \quad vs \quad H_1 : \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2_{1}\)</span>, Uniform(0,2), and Exponential(1), respectively.<br>
解: 单样本t检验，适用于样本均值与总体均值的比较，是检验样本均值所代表的的总体均值是否与理论值有差别</p>
<p>I 型错误率是<span class="math inline">\(H_0\)</span>正确，但是推翻<span class="math inline">\(H_0\)</span>接受<span class="math inline">\(H_1\)</span>的概率是<span class="math inline">\(\alpha\)</span> <span class="math inline">\(E[\chi_1^2] = E[u(0,2)] =E[E(1))]= 1\)</span><br>
则检验问题变成 <span class="math inline">\(H_0 : \mu = 1 \quad vs \quad H_1 : \mu \neq 1\)</span> <span class="math inline">\(t1e = \frac{1}{m}\sum_{j=1}^m I(p_j \leq \alpha)\)</span></p>
<p><span class="math inline">\(T^* = \frac{\bar{X}-\mu_0}{S/\sqrt{n}} \sim t(n-1)\)</span><br>
(1)</p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1e4</span> <span class="co">##瀹為獙娆℃暟</span>NA<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e3</span> <span class="co">##姣忔瀹為獙鐨勬牱鏈暟</span>NA<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co">#瀛樺偍 p-values</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>,df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>,alternative <span class="op">=</span> <span class="st">"two.sided"</span>,mu <span class="op">=</span> <span class="va">mu0</span>,conf.level <span class="op">=</span><span class="fl">1</span><span class="op">-</span> <span class="va">alpha</span><span class="op">)</span>
  <span class="va">p</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ttest</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span>
<span class="va">p.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span>
<span class="va">se.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p.hat</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p.hat</span><span class="op">)</span> <span class="op">/</span> <span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p.hat</span>, <span class="va">se.hat</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>观察到的 t1e = 0.051, 估计值的标准误差是 <span class="math inline">\(\hat{se}(\hat{p}) = 0.0022\)</span> <span class="math inline">\(t1e &gt; \alpha\)</span>,但是在一个标准误差范围内，理论上讲,当<span class="math inline">\(\mu =1\)</span>时,拒绝空假设的概率正好是 <span class="math inline">\(\alpha\)</span> 模拟从经验上调查，t.test中的p值计算方法是否与理论值<span class="math inline">\(\alpha\)</span>相一致<br>
实验上发现，t1e和取的样本大小有关，越大和<span class="math inline">\(\alpha\)</span>越接近，而越小，偏离越远</p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1e3</span> <span class="co">##瀹為獙娆℃暟</span>NA<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e1</span>,<span class="fl">1e2</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">1e2</span>,<span class="fl">1e3</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">1e3</span>,<span class="fl">1e4</span>,<span class="fl">2</span><span class="op">*</span><span class="fl">1e4</span>,<span class="fl">3</span><span class="op">*</span><span class="fl">1e4</span>,<span class="fl">4</span><span class="op">*</span><span class="fl">1e4</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">1e4</span>,<span class="fl">6</span><span class="op">*</span><span class="fl">1e4</span>,<span class="fl">1e5</span><span class="op">)</span> <span class="co">##姣忔瀹為獙鐨勬牱鏈暟</span>NA<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">p.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="va">se.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co">#瀛樺偍 p-values</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
    <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">k</span>,df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>,alternative <span class="op">=</span> <span class="st">"two.sided"</span>,mu <span class="op">=</span> <span class="va">mu0</span>,conf.level <span class="op">=</span><span class="fl">1</span><span class="op">-</span> <span class="va">alpha</span><span class="op">)</span>
    <span class="va">p</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ttest</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span>
  <span class="va">p.hat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span>
  <span class="va">se.hat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p.hat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p.hat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">m</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">p.hat</span><span class="op">/</span><span class="va">alpha</span><span class="op">)</span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
</ol>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1e4</span> <span class="co">##瀹為獙娆℃暟</span>NA<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e3</span> <span class="co">##姣忔瀹為獙鐨勬牱鏈暟</span>NA<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co">#瀛樺偍 p-values</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>
  <span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>,alternative <span class="op">=</span> <span class="st">"two.sided"</span>,mu <span class="op">=</span> <span class="va">mu0</span>,conf.level <span class="op">=</span><span class="fl">1</span><span class="op">-</span> <span class="va">alpha</span><span class="op">)</span>
  <span class="va">p</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ttest</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span>
<span class="va">p.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span>
<span class="va">se.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p.hat</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p.hat</span><span class="op">)</span> <span class="op">/</span> <span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p.hat</span>, <span class="va">se.hat</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>观察到的 t1e = 0.0476, 估计值的标准误差是 <span class="math inline">\(\hat{se}(\hat{p}) = 0.0021\)</span> <span class="math inline">\(t1e &gt; \alpha\)</span>,但是在一个标准误差范围内，理论上讲,当<span class="math inline">\(\mu =1\)</span>时,拒绝空假设的概率正好是 <span class="math inline">\(\alpha\)</span> 模拟从经验上调查，t.test中的p值计算方法是否与理论值<span class="math inline">\(\alpha\)</span>相一致<br>
(3)</p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1e4</span> <span class="co">##瀹為獙娆℃暟</span>NA<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e3</span> <span class="co">##姣忔瀹為獙鐨勬牱鏈暟</span>NA<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>  <span class="co">#瀛樺偍 p-values</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>,rate <span class="op">=</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">ttest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">x</span>,alternative <span class="op">=</span> <span class="st">"two.sided"</span>,mu <span class="op">=</span> <span class="va">mu0</span>,conf.level <span class="op">=</span><span class="fl">1</span><span class="op">-</span> <span class="va">alpha</span><span class="op">)</span>
  <span class="va">p</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ttest</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span>
<span class="va">p.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;</span> <span class="va">alpha</span><span class="op">)</span>
<span class="va">se.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">p.hat</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p.hat</span><span class="op">)</span> <span class="op">/</span> <span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p.hat</span>, <span class="va">se.hat</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>观察到的 t1e = 0.0557, 估计值的标准误差是 <span class="math inline">\(\hat{se}(\hat{p}) = 0.00229\)</span> <span class="math inline">\(t1e &gt; \alpha\)</span>,但是在一个标准误差范围内，理论上讲,当<span class="math inline">\(\mu =1\)</span>时,拒绝空假设的概率正好是 <span class="math inline">\(\alpha\)</span> 模拟从经验上调查，t.test中的p值计算方法是否与理论值<span class="math inline">\(\alpha\)</span>相一致</p>
</div>
<div class="section level4">
<h4 id="supplement">Supplement<a class="anchor" aria-label="anchor" href="#supplement"></a>
</h4>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br>
(1)What is the corresponding hypothesis test problem?<br>
(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br>
(3)Please provide the least necessary information for hypothesis testing.</p>
<p>解:检验的Power:<span class="math inline">\(\pi(\theta)=1-\beta\)</span>是在知道参数真值为<span class="math inline">\(\theta\)</span>时,拒绝<span class="math inline">\(H_0\)</span>的概率,II型错误率是<span class="math inline">\(1-\pi(\theta)\)</span>功效分析是在知道：显著性水平，功效，效应值，样本大小,三者中任意三个值，求另一个值<br>
(1) <span class="math inline">\(H_0: 方法1和方法2的power相同 \leftrightarrow H_{\alpha}:方法1和方法2的power不同 \neq 0\)</span><br>
(2) McNemar,用来比较两种方法是否有显著性差异 <span class="math inline">\(\tau_{\chi^2}=\frac{(|Power_1-Power_2|-1)^2}{Power_1+Power_2} \sim \chi_1^2\)</span></p>
<pre><code><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">0.651</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fl">0.676</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p1</span><span class="op">-</span><span class="va">p2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="va">p1</span><span class="op">+</span><span class="va">p2</span><span class="op">)</span>
<span class="va">xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span>,df <span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tau</span>,<span class="va">xi</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>因此 0.7163715&lt;3.8414588 不能拒绝零假设 (3)We need another information for hypothesis testing. 1)需要知道自由度为1的卡方分布的 <span class="math inline">\(100(1-\alpha)\%\)</span>分位数 是3.8414</p>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td align="left">## The homework 4 2021-10-21</td>
</tr>
<tr class="even">
<td align="left">### Question Exercises 6.C (Statistical Computatingwith R).</td>
</tr>
<tr class="odd">
<td align="left">### Answer</td>
</tr>
<tr class="even">
<td align="left">#### 6.C Repeat Examples <span class="math inline">\(6.8\)</span> and <span class="math inline">\(6.10\)</span> for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1, d}\)</span> is defined by Mardia as <span class="math display">\[
\begin{align}
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}
\end{align}
\]</span>
</td>
</tr>
<tr class="odd">
<td align="left">Under normality, <span class="math inline">\(\beta_{1, d}=0 .\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}
\]</span>
</td>
</tr>
<tr class="even">
<td align="left">where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1, d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(n b_{1, d} / 6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2) / 6\)</span> degrees of freedom.</td>
</tr>
<tr class="odd">
<td align="left">解: 协方差矩阵的极大似然估计为 <span class="math display">\[
\begin{align}
设X_i是 d\times 1为向量,则 \quad\hat{\Sigma} = \frac{1}{n} \sum_{i=1}^n (X_i-\bar{X})(X_i-\bar{X})^{T}
\end{align}
\]</span>
</td>
</tr>
<tr class="even">
<td align="left"><code>rm(list = ls()) n &lt;- c(10,20,30,50,100,500,1000,2000) d &lt;- 3 m&lt;- 1000 p.reject &lt;- numeric(length(n)) alpha &lt;- 0.05 likecov &lt;- function(x) { ##设 x 是 d*n的矩阵,d是维数,n是数据量 d1 &lt;- nrow(x) n1 &lt;- ncol(x) mu1 &lt;- rowSums(x)/n1  ## 按照行均值 xx &lt;- sweep(x,1,mu1)  #减去均值 return(xx%*%t(xx)/(n1)) } msk &lt;- function(x){ invsigma &lt;- solve(likecov(x)) d2 &lt;- nrow(x) n2 &lt;- ncol(x) mu2 &lt;- rowSums(x)/n2 xx &lt;- sweep(x,1,mu2) return( sum((t(xx)%*%invsigma%*%xx)^3)/(n2*n2)) } gennormmatrx &lt;- function(d3,n3){ # d多少维 # n多少个 y &lt;- matrix(0,d3,n3) for (i in 1:n3){ for (j in 1:d3){} y[,i] = rnorm(d3) } return(y) } cv &lt;- qchisq(1-alpha,df = d*(d+1)*(d+2)/6) sktests &lt;- numeric(m) for (i in 1:length(n)){ sktests &lt;- numeric(m) for (j in 1:m){ x &lt;- gennormmatrx(d,n[i]) # test decision is 1(reject) or 0 sktests[j] &lt;- as.integer((n[i]*msk(x)/6)&gt;=cv) } p.reject[i] &lt;- mean(sktests) } results &lt;- matrix(0,2,length(n)) results[1,] = n results[2,] = p.reject rownames(results) = c("n","estimate") colnames(results) = c(1:length(n)) results</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-5-2021-10-28">The homework 5 2021-10-28<a class="anchor" aria-label="anchor" href="#the-homework-5-2021-10-28"></a>
</h2>
<div class="section level3">
<h3 id="question-4">Question<a class="anchor" aria-label="anchor" href="#question-4"></a>
</h3>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R)</p>
</div>
<div class="section level3">
<h3 id="answer-4">Answer<a class="anchor" aria-label="anchor" href="#answer-4"></a>
</h3>
<div class="section level4">
<h4 id="section-7">7.7<a class="anchor" aria-label="anchor" href="#section-7"></a>
</h4>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a <span class="math inline">\(5 \times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_{1}&gt;\cdots&gt;\lambda_{5} .\)</span> In principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_{1}}{\sum_{j=1}^{5} \lambda_{j}}
\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the <span class="math inline">\(\mathrm{MLE}\)</span> of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div class="section level4">
<h4 id="solution">Solution<a class="anchor" aria-label="anchor" href="#solution"></a>
</h4>
<pre><code>rm(list = ls())
library(knitr)
library(bootstrap) #for the law data

score &lt;- matrix(0,length(scor$mec),5)  # 88*5
score[,1] &lt;- scor$mec
score[,2] &lt;- scor$vec
score[,3] &lt;- scor$alg
score[,4] &lt;- scor$ana
score[,5] &lt;- scor$sta

n &lt;- length(scor$mec)
xigma.hat &lt;- cov(score)
xigma.ev &lt;-eigen(xigma.hat)
xigma.lambda &lt;- xigma.ev$values
theta.hat &lt;- xigma.lambda[1]/sum(xigma.lambda)

B &lt;- 5000
theta.b &lt;-numeric(B)
for (b in 1:B){
  i&lt;- sample(1:n,size = n,replace = TRUE)
  xigma0.hat &lt;- cov(score[i,])
  xigma0.ev &lt;- eigen(xigma0.hat)
  xigma0.lambda &lt;- xigma0.ev$values
  theta.b[b] &lt;- xigma0.lambda[1]/sum(xigma0.lambda)
}
bias &lt;- mean(theta.b)-theta.hat
se.theta &lt;- B/(B-1)*var(theta.b)
boot.theta.hat &lt;- mean(theta.b)
standard.error &lt;- sqrt(se.theta)

result &lt;- cbind(theta.hat, boot.theta.hat, bias,standard.error)#合并计算结果
dimnames(result)[[2]] &lt;- c("theta", "Bootstrap theta.hat", "bias", "standard error")#重命名各列
kable(result, caption = "表1：用bootstrap估计theta.hat的bias和standard error") #利用kable绘制计算结</code></pre>
</div>
<div class="section level4">
<h4 id="section-8">7.8<a class="anchor" aria-label="anchor" href="#section-8"></a>
</h4>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div class="section level4">
<h4 id="solution-1">Solution<a class="anchor" aria-label="anchor" href="#solution-1"></a>
</h4>
<pre><code>rm(list = ls())
library(bootstrap) #for the law data
library(knitr)

score &lt;- matrix(0,length(scor$mec),5)  # 88*5
score[,1] &lt;- scor$mec
score[,2] &lt;- scor$vec
score[,3] &lt;- scor$alg
score[,4] &lt;- scor$ana
score[,5] &lt;- scor$sta

n &lt;- length(scor$mec)
xigma.hat &lt;- cov(score)
xigma.ev &lt;-eigen(xigma.hat)
xigma.lambda &lt;- xigma.ev$values
theta.hat &lt;- xigma.lambda[1]/sum(xigma.lambda)

theta.jack &lt;-numeric(n)

for (i in 1:n){
  xigma0.hat &lt;- cov(score[-i,])  #Jackknife
  xigma0.ev &lt;- eigen(xigma0.hat)
  xigma0.lambda &lt;- xigma0.ev$values
  theta.jack[i] &lt;- xigma0.lambda[1]/sum(xigma0.lambda)
}
bias.jack &lt;- (n-1)*(mean(theta.jack)-theta.hat)
bias.se &lt;- sqrt((n-1)*mean(theta.jack-mean(theta.jack))^2)


jack.theta.hat &lt;- mean(theta.jack)
standard.error &lt;- sd(theta.jack)

result &lt;- cbind(theta.hat, jack.theta.hat, bias.jack,standard.error)#合并计算结果
dimnames(result)[[2]] &lt;- c("theta", "Jackknife theta.hat", "bias", "standard error")#重命名各列
kable(result, caption = "表2：用Jackknife估计theta.hat的bias和standard error") #利用kable绘制计算结</code></pre>
</div>
<div class="section level4">
<h4 id="section-9">7.9<a class="anchor" aria-label="anchor" href="#section-9"></a>
</h4>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>. #### Solution</p>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/scottkosty/bootstrap" class="external-link">bootstrap</a></span><span class="op">)</span> <span class="co">#for the law data</span>
<span class="va">level</span> <span class="op">&lt;-</span> <span class="fl">0.95</span>

<span class="va">boot.se</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">R</span>,<span class="va">f</span><span class="op">)</span><span class="op">{</span>
  <span class="co">#local function to compute the bootstrap</span>
  <span class="co">#estimate of standard error for statistic f(x)</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>; <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">R</span>, expr <span class="op">=</span> <span class="op">{</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, size <span class="op">=</span> <span class="va">m</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">scor</span><span class="op">$</span><span class="va">mec</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span>  <span class="co"># 88*5</span>
<span class="va">score</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scor</span><span class="op">$</span><span class="va">mec</span>
<span class="va">score</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scor</span><span class="op">$</span><span class="va">vec</span>
<span class="va">score</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scor</span><span class="op">$</span><span class="va">alg</span>
<span class="va">score</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scor</span><span class="op">$</span><span class="va">ana</span>
<span class="va">score</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scor</span><span class="op">$</span><span class="va">sta</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">scor</span><span class="op">$</span><span class="va">mec</span><span class="op">)</span>
<span class="va">xigma.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span>
<span class="va">xigma.ev</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">xigma.hat</span><span class="op">)</span>
<span class="va">xigma.lambda</span> <span class="op">&lt;-</span> <span class="va">xigma.ev</span><span class="op">$</span><span class="va">values</span>
<span class="va">theta.hat</span> <span class="op">&lt;-</span> <span class="va">xigma.lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xigma.lambda</span><span class="op">)</span>

<span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">5000</span>  <span class="co">#璁＄畻bootstrp鐨勬鏁<b0></b0></span>NA<span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co">##璁＄畻鏍囧噯宸殑娆℃暟</span>NA<span class="va">theta.b</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>

<span class="va">statistic</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">xigma0.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">xigma0.ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">xigma0.hat</span><span class="op">)</span>
  <span class="va">xigma0.lambda</span> <span class="op">&lt;-</span> <span class="va">xigma0.ev</span><span class="op">$</span><span class="va">values</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xigma0.lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xigma0.lambda</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span><span class="op">{</span>
  <span class="va">i</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>,size <span class="op">=</span> <span class="va">n</span>,replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">boostrapscore</span> <span class="op">&lt;-</span> <span class="va">score</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>
  <span class="va">xigma0.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">boostrapscore</span><span class="op">)</span>
  
  <span class="va">th</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">R</span>,expr<span class="op">=</span><span class="op">{</span>
    <span class="va">j</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>,size <span class="op">=</span> <span class="va">n</span>,replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="fu">statistic</span><span class="op">(</span><span class="va">boostrapscore</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
  <span class="va">xigma0.ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">xigma0.hat</span><span class="op">)</span>
  <span class="va">xigma0.lambda</span> <span class="op">&lt;-</span> <span class="va">xigma0.ev</span><span class="op">$</span><span class="va">values</span>
  <span class="va">theta.b</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xigma0.lambda</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xigma0.lambda</span><span class="op">)</span>
  <span class="va">se</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta.b</span><span class="op">)</span><span class="op">-</span><span class="va">theta.hat</span>
<span class="va">se.theta</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">/</span><span class="op">(</span><span class="va">B</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">theta.b</span><span class="op">)</span>
<span class="va">boot.theta.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta.b</span><span class="op">)</span>
<span class="va">standard.error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">se.theta</span><span class="op">)</span>

<span class="va">stat0</span> <span class="op">&lt;-</span> <span class="fu">statistic</span><span class="op">(</span><span class="va">score</span><span class="op">)</span>
<span class="va">stat</span> <span class="op">&lt;-</span> <span class="va">theta.b</span>
<span class="va">se0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span>
<span class="va">t.stats</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">stat</span><span class="op">-</span><span class="va">stat0</span><span class="op">)</span><span class="op">/</span><span class="va">se</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">level</span>

<span class="va">Qt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">t.stats</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,type<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Qt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Qt</span><span class="op">)</span><span class="op">)</span>
<span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">stat0</span><span class="op">-</span><span class="va">Qt</span><span class="op">*</span><span class="va">se0</span><span class="op">)</span>
<span class="va">CI</span></code></pre>
</div>
<div class="section level4">
<h4 id="b">7.B<a class="anchor" aria-label="anchor" href="#b"></a>
</h4>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2_5\)</span> distributions (positive skewness).</p>
</div>
<div class="section level4">
<h4 id="solution-2">Solution<a class="anchor" aria-label="anchor" href="#solution-2"></a>
</h4>
<pre><code><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  <span class="co">#鏍锋湰鏁伴噺</span>NA<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>
<span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">200</span>  <span class="co">#bootstrap 娆℃暟</span>NA<span class="va">sk</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="co"># 璁＄畻缁熻鍊<bc></bc></span>NA<span class="va">sample.skewness</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>
    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>
    <span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sample</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
    <span class="va">denom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="va">num</span><span class="op">/</span><span class="va">denom</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">theta.hat</span> <span class="op">&lt;-</span> <span class="fu">sample.skewness</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span>
  
  
  <span class="va">theta.hat.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
  
  <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">n</span>, <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">xs.b</span> <span class="op">&lt;-</span> <span class="va">xs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="va">theta.hat.b</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">sample.skewness</span><span class="op">(</span><span class="va">xs.b</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">sd.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">theta.hat.b</span><span class="op">)</span>
  
  <span class="co"># 鍙鍖&lt;96&gt;</span>NA<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">theta.hat.b</span><span class="op">)</span>
  
  <span class="co"># 缃俊鍖洪棿</span>NA<span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">probs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="fl">100</span>, <span class="st">'%'</span>, <span class="va">sep</span> <span class="op">&lt;-</span> <span class="st">''</span><span class="op">)</span><span class="op">)</span>
  <span class="va">qs.theta.hat.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">theta.hat.b</span>, <span class="va">probs</span><span class="op">)</span>
  
  <span class="co"># 鏍囧噯姝ｆ€佸尯闂<b4></b4></span>NA<span class="va">qs.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span>
  <span class="va">ci.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">theta.hat</span> <span class="op">-</span> <span class="va">qs.norm</span> <span class="op">*</span> <span class="va">sd.hat</span><span class="op">)</span>
  
  <span class="co"># 鍩烘湰 bootstrap鍖洪棿</span>NA<span class="va">ci.basic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">theta.hat</span> <span class="op">-</span> <span class="va">qs.theta.hat.b</span><span class="op">)</span>
  
  <span class="co"># percentile.</span>
  <span class="va">ci.percentile</span> <span class="op">&lt;-</span> <span class="va">qs.theta.hat.b</span>
  
  <span class="va">ci.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ci.norm</span>, <span class="va">ci.basic</span>, <span class="va">ci.percentile</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ci.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">names</span>
  <span class="va">ci.data</span><span class="op">[</span><span class="st">'left.miss'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">ci.data</span><span class="op">[</span><span class="st">'right.miss'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  
  <span class="co"># MC study.</span>
  <span class="va">rep</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
  
  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">skew</span> <span class="op">&lt;-</span> <span class="fu">sample.skewness</span><span class="op">(</span><span class="va">xs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ci.data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="va">names</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
      <span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="va">names</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">skew</span> <span class="op">&lt;</span> <span class="va">lower</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="st">'left.miss'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="st">'left.miss'</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">skew</span> <span class="op">&gt;</span> <span class="va">upper</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="st">'right.miss'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">[</span><span class="va">y</span>,<span class="st">'right.miss'</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  
  <span class="va">ci.data</span><span class="op">$</span><span class="va">left.miss</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">$</span><span class="va">left.miss</span><span class="op">/</span><span class="va">rep</span>
  <span class="va">ci.data</span><span class="op">$</span><span class="va">right.miss</span> <span class="op">&lt;-</span> <span class="va">ci.data</span><span class="op">$</span><span class="va">right.miss</span><span class="op">/</span><span class="va">rep</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ci.data</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="fu">sk</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>

<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>
<span class="va">mux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">mux</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>

<span class="fu">sk</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></code></pre>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td align="left">## The homework 6 2021-11-04</td>
</tr>
<tr class="even">
<td align="left">### Question</td>
</tr>
<tr class="odd">
<td align="left">Exercise 8.2 (page 242, Statistical Computating with R).</td>
</tr>
<tr class="even">
<td align="left">### Answer</td>
</tr>
<tr class="odd">
<td align="left">#### 8.2</td>
</tr>
<tr class="even">
<td align="left">Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</td>
</tr>
<tr class="odd">
<td align="left">#### Solution</td>
</tr>
<tr class="even">
<td align="left">``` rm(list=ls()) library(knitr)</td>
</tr>
<tr class="odd">
<td align="left">set.seed(1355)</td>
</tr>
<tr class="even">
<td align="left">m1 &lt;- 1000 m2 &lt;- 1000 set.seed(9999) x &lt;- rnorm(m1,1,10) y &lt;- rchisq(m2,2)</td>
</tr>
<tr class="odd">
<td align="left">R &lt;- 999 z &lt;- c(x,y) K &lt;- 1:(m1+m2) reps &lt;- numeric(R)</td>
</tr>
<tr class="even">
<td align="left">c0 &lt;- cor(x,y,method = “spearman”) #统计量</td>
</tr>
<tr class="odd">
<td align="left">for (i in 1:R){ k &lt;- sample(K,size = m1,replace = FALSE) x1 &lt;- z[k] y1 &lt;- z[-k] reps[i] &lt;- cor(x1,y1,method = “spearman”) }</td>
</tr>
<tr class="even">
<td align="left">p &lt;- mean(c(c0,reps)&gt;=c0)</td>
</tr>
<tr class="odd">
<td align="left">cat(“boot p =”,p)</td>
</tr>
<tr class="even">
<td align="left">cor.test(x,y,method = “spearman”)</td>
</tr>
<tr class="odd">
<td align="left">```</td>
</tr>
<tr class="even">
<td align="left">发现的p-value=0.446&gt;0.05,因此在显著性水平<span class="math inline">\(1-\alpha\)</span>情况下应该拒绝<span class="math inline">\(H_0\)</span>，即x和y是不相关的</td>
</tr>
<tr class="odd">
<td align="left">从cor.test也得出相同的结论，相关性都非常低</td>
</tr>
<tr class="even">
<td align="left">#### Supplement</td>
</tr>
<tr class="odd">
<td align="left">Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</td>
</tr>
<tr class="even">
<td align="left">(1) Unequal variances and equal expectations</td>
</tr>
<tr class="odd">
<td align="left">(2) Unequal variances and unequal expectations</td>
</tr>
<tr class="even">
<td align="left">(3) Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</td>
</tr>
<tr class="odd">
<td align="left">(4) Unbalanced samples (say, 1 case versus 10 controls)</td>
</tr>
<tr class="even">
<td align="left">Note: The parameters should be chosen such that the powers are 2 (say, range from 0.3 to 0.8).</td>
</tr>
<tr class="odd">
<td align="left">``` #计算NN的p-value library(boot) library(FNN) library(energy) library(Ball) Tn3 &lt;- function(z, ix, sizes) { n1 &lt;- sizes[1] n2 &lt;- sizes[2] n &lt;- n1 + n2 z &lt;- z[ix, ] o &lt;- rep(0, NROW(z)) z &lt;- as.data.frame(cbind(z, o)) NN &lt;- get.knn(z, k=3) block1 &lt;- NN<span class="math inline">\(nn.index[1:n1, ] block2 &lt;- NN\)</span>nn.index[(n1+1):n, ] i1 &lt;- sum(block1 &lt; n1 + .5) i2 &lt;- sum(block2 &gt; n1 + .5) return((i1 + i2) / (3 * n)) }</td>
</tr>
<tr class="even">
<td align="left">## 使用NNp(x,y)可以直接得出p-value NNp &lt;- function(x,y){ z &lt;- c(x,y) o &lt;- rep(0, NROW(z)) z &lt;- as.data.frame(cbind(z, o)) N &lt;- c(length(x),length(y)) boot.obj &lt;- boot(data =z ,statistic = Tn3, sim=“permutation”, R=999,sizes =N) #boot.obj tb &lt;- c(boot.obj<span class="math inline">\(t,boot.obj\)</span>t0) return(mean(tb&gt;=boot.obj$t0)) }</td>
</tr>
<tr class="odd">
<td align="left"># Energy的p-value</td>
</tr>
<tr class="even">
<td align="left">Energy &lt;- function(x,y){ m1 &lt;- length(x) m2 &lt;- length(y) z &lt;- rbind(x, y) d &lt;- dist(z) obj &lt;- eqdist.etest(d, sizes=c(1, 1), distance=TRUE, R = m1+m2-1) return(obj$p.value) }</td>
</tr>
<tr class="odd">
<td align="left">Ballmethod &lt;- function(x,y){ #输入的x,y维度要相等 m1 &lt;- length(x) m2 &lt;- length(y) if (m1!=m2){ return(“维度不一样”) } else{ obj &lt;-bcov.test(x,y,method = “permutation”) return(obj$p.value) } }</td>
</tr>
<tr class="even">
<td align="left"># ball methods 的p-value ``` (1) <span class="math inline">\(用指数分布E[x] = 1/\lambda ,Var[x] =1/\lambda\^2正态分布 E[y]=1/\lambda,Var[y] = \sigma\^2\)</span>
</td>
</tr>
<tr class="odd">
<td align="left">``` set.seed(12345) n &lt;- 200 x &lt;- rnorm(n,2,4) y &lt;- rnorm(n,2,8)</td>
</tr>
<tr class="even">
<td align="left"># NN 检验方法 NNp(x,y) ## Energy 检验方法 Energy(x,y) ## Ball 检验方法 Ballmethod(x,y) ``` 结果三者的p-value很小,都小于0.05,分布相等的假设被拒绝</td>
</tr>
<tr class="odd">
<td align="left">(2)使用正态分布来检验 ``` n &lt;- 200 x &lt;- rnorm(n,2,4) y &lt;- rnorm(n,4,8)</td>
</tr>
<tr class="even">
<td align="left"># NN 检验方法 NNp(x,y) ## Energy 检验方法 Energy(x,y) ## Ball 检验方法 Ballmethod(x,y)</td>
</tr>
<tr class="odd">
<td align="left">
<code>(3) t分布</code> set.seed(1231) n &lt;- 1000 x &lt;- rt(n,df =1)</td>
</tr>
<tr class="even">
<td align="left"># p<em>N(0,1)+(1-p)</em>N(0,3) p &lt;- 0.3 y &lt;- numeric(n) for(i in 1:n){ if (runif(1)&lt;p){ y[i] &lt;- rnorm(1,0,1) } else{ y[i] &lt;- rnorm(1,0,3) } }</td>
</tr>
<tr class="odd">
<td align="left"># NN 检验方法 NNp(x,y) ## Energy 检验方法 Energy(x,y) ## Ball 检验方法 Ballmethod(x,y)</td>
</tr>
<tr class="even">
<td align="left">``` 三种方法的<span class="math inline">\(p-value\)</span>都很小,小于0.05，因此分布相等的假设被拒绝</td>
</tr>
<tr class="odd">
<td align="left">(4) ``` set.seed(12345) n1 &lt;- 200 n2 &lt;- n1*10 x &lt;- rnorm(n1,2,4) y &lt;- rnorm(n2,2,8)</td>
</tr>
<tr class="even">
<td align="left"># NN 检验方法 NNp(x,y) ## Energy 检验方法 Energy(x,y) ## Ball 检验方法 Ballmethod(x,y) ``` 前两种方法的<span class="math inline">\(p-value\)</span>都很小,小于0.05，因此分布相等的假设被拒绝</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-7-2021-11-11">The homework 7 2021-11-11<a class="anchor" aria-label="anchor" href="#the-homework-7-2021-11-11"></a>
</h2>
<div class="section level3">
<h3 id="question-5">Question<a class="anchor" aria-label="anchor" href="#question-5"></a>
</h3>
<p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R)</p>
</div>
<div class="section level3">
<h3 id="answer-5">Answer<a class="anchor" aria-label="anchor" href="#answer-5"></a>
</h3>
<div class="section level4">
<h4 id="section-10">9.3<a class="anchor" aria-label="anchor" href="#section-10"></a>
</h4>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a <span class="math inline">\(Cauchy(θ, η)\)</span> distribution has density function <span class="math display">\[
f(x) = \frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}, -\infty&lt;x&lt;\infty,\theta&gt;0
\]</span> #### Solution</p>
<pre><code>rm(list = ls())
library(knitr)
# Causcht(theta,eta)
set.seed(1145140)

Gelman.Rubin &lt;- function(psi) {
  # psi[i,j] 是 检验函数 psi(X[i,1:j])的值
  # X的第i行为第i条链
  psi &lt;- as.matrix(psi)
  n &lt;- ncol(psi)
  k &lt;- nrow(psi)
  psi.means &lt;- rowMeans(psi) #所有行的平均值，链之间的平均
  B &lt;- n * var(psi.means) # 链之间的方差估计
  psi.w &lt;- apply(psi, 1, "var") #within variances
  W &lt;- mean(psi.w) #within est.
  v.hat &lt;- W*(n-1)/n + (B/n) #upper variance est.
  r.hat &lt;- v.hat / W #G-R statistic
  return(r.hat)
}

normal.chain&lt;-function(N,theta,eta,X1){
  x &lt;- numeric(N)
  x[1] &lt;- X1
  k &lt;- 0
  u &lt;- runif(N)
  for (i in 2:N) {
  xt &lt;- x[i-1]
  y &lt;- rnorm(1, xt)
  shang &lt;- df(y,theta=theta, eta=eta) * dnorm(xt, y)
  xia &lt;- df(xt, theta=theta, eta=eta) * dnorm(y, xt)
  if (u[i] &lt;= shang/xia) x[i] &lt;- y 
  
  else {
    x[i] &lt;- xt
    k &lt;- k+1 #y 被拒绝
    }
  }
  return(x)
}


df &lt;- function(x,theta,eta) {
  stopifnot(theta &gt; 0)
  return(1 /(theta*pi*(1+((x-eta)/theta)^2) ))
}

m &lt;- 10000  #样本长度
b &lt;- 1000 #去掉的长度
theta &lt;- 1
eta &lt;- 0
burn &lt;- 1000


x0 &lt;- c(-10,-5,1,2,5,10,15,20)  #设置初始值
K &lt;- length(x0)

#产生链
X &lt;- matrix(0,nrow = K,ncol=m)
for (i in 1:K){
  X[i,] &lt;- normal.chain(m,theta,eta,x0[i])
  
}


index &lt;- burn+1:m
# 选择第3条链来进行绘图
xx &lt;- X[3,]
y1 &lt;- xx[index]  #产生的MCMC

y2 &lt;- rcauchy(length(y1), location = 0, scale = 1)  #cauchy产生的
par(mfrow = c(1,2))
plot(index, y1,type="l",main="去掉前面1000个样本后的M-H链", ylab="X")
hist(y1, probability = TRUE, breaks = 100,main="密度分布图",xlab="X")

plot.y1 &lt;- seq(min(xx), max(xx), 0.01)
lines(plot.y1, df(plot.y1,theta=theta, eta=eta),main="密度分布图",xlab="X")
par(mfrow = c(1,1))

#psi &lt;- t(apply(X, 1, cumsum))
#for (i in 1:nrow(psi)) psi[i,] &lt;- psi[i,] / (1:ncol(psi))

paste("R=",Gelman.Rubin(X))


rhat &lt;- rep(0, m)
for (j in (b+1):m){
  rhat[j] &lt;- Gelman.Rubin(X[,1:j])
}
plot(rhat[(b+1):m], main = bquote(R),type="l", xlab="", ylab="R")
abline(h=1.1, lty=2)

## 计算分位数

qmh &lt;- c(1:K)
qcau &lt;- c(1:K)
for (i in 1:K){
  qmh[i] &lt;- quantile(X[i,],c(0.1))
  qcau[i] &lt;- qcauchy(0.1, 0,1)
}
result &lt;- cbind(qmh,qcau)  #合并计算结果
dimnames(result)[[2]] &lt;- c("M-H 10%分位数", "标准柯西10%分位数") #重命名各列
kable(result, caption = "分位数对比")
</code></pre>
<p>可以看出产生的分布和实际分布拟合的很好</p>
</div>
<div class="section level4">
<h4 id="section-11">9.8<a class="anchor" aria-label="anchor" href="#section-11"></a>
</h4>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto \left( \begin{array}{c} n \\ x \end{array} \right) y^{x+a-1}(1-y)^{n-x+b-1} , x=0,1,...,n, 0\leq y\leq 1
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are <span class="math inline">\(Binomial(n, y)\)</span> and <span class="math inline">\(Beta(x+ a, n−x+ b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span></p>
</div>
<div class="section level4">
<h4 id="solution-3">Solution<a class="anchor" aria-label="anchor" href="#solution-3"></a>
</h4>
<p><span class="math display">\[
f(X|Y) = Binomial(n,y) = \left( \begin{array}{c} n \\ x \end{array} \right) y^{x}(1-y)^{n-x} \\
E[X|Y] =  ny  \\
f(Y|X) = Beta(x+a,n-x+b) = \frac{\Gamma(a+n+b)}{\Gamma(x+a)\Gamma(n-x+b)}y^{x+a-1}(1-y)^{n-x+b-1} \\
E[Y|X] = \frac{x+a}{n+a+b}\\
\]</span></p>
<pre><code>N &lt;- 5000 #链的长度
burn &lt;- 1000 #burn-in length

###### Mode Parameter #####
n &lt;- 50
a &lt;- 1
b &lt;- 2

###### 产生链的函数 #####
bivariate.chain &lt;- function(N,n,a,b,X1,Y1){
  # N个数据点 参数 n,a,b,初值 X1,Y1
  data &lt;- list(X = matrix(0,1,N),Y=matrix(0,1,N)) #the chain, a bivariate sample
  data$X[1] &lt;- X1
  data$Y[1] &lt;- Y1
  for ( i in 2:N){
    x2 &lt;- data$Y[i-1]
    data$X[i] &lt;- rbinom(1, n, x2)
    x1 &lt;- data$X[i]
    data$Y[i] &lt;- rbeta(1,x1+a,n-x1+b)
  }
  return(data)
}



#每条链的初始值
x0 &lt;- c(1,5,10,15,20,50,100)
y0 &lt;- c(0.01,0.05,0.1,0.2,0.5,0.7,0.9)
K &lt;- length(x0)  #几条链

#产生链
X &lt;- matrix(0,K,N)
Y &lt;- matrix(0,K,N)
for (i in 1:K){
  data &lt;- bivariate.chain(N,n,a,b,x0[i],y0[i])
  X[i,] &lt;- data$X
  Y[i,] &lt;- data$Y
}



bs &lt;- burn+1
index &lt;- (burn+1):N
x &lt;- X[1,index]
y &lt;- Y[1,index]


plot(t(rbind(x,y)), main="联合密度分布图", cex=.5, xlab="X",ylab="Y", ylim=range(y))

#产生的MCMC

par(mfrow = c(1,2))
plot(index, x,type="l",main="X的去掉前面1000个样本后的Gibbs链", ylab="X")
hist(x, probability = TRUE, breaks = 100,main="密度分布图",xlab="X")
par(mfrow = c(1,1))

par(mfrow = c(1,2))
plot(index, y,type="l",main="Y的去掉前面1000个样本后的Gibbs链", ylab="Y")
hist(y, probability = TRUE, breaks = 100,main="密度分布图",xlab="Y")
par(mfrow = c(1,1))
paste("Rx=",Gelman.Rubin(X))
paste("Ry=",Gelman.Rubin(Y))

#plot the sequence of R-hat statistics
rhat &lt;- rep(0, N)
for (j in (b+1):N){
  rhat[j] &lt;- Gelman.Rubin(X[,1:j])
}
plot(rhat[bs:N], type="l", xlab="", ylab="R")
abline(h=1.1, lty=2)


rhat &lt;- rep(0, N)
for (j in (b+1):N){
  rhat[j] &lt;- Gelman.Rubin(Y[,1:j])
}
plot(rhat[bs:N], type="l", xlab="", ylab="R")
abline(h=1.1, lty=2)
</code></pre>
</div>
<div class="section level4">
<h4 id="supplement-1">Supplement<a class="anchor" aria-label="anchor" href="#supplement-1"></a>
</h4>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span></p>
</div>
<div class="section level4">
<h4 id="solution-4">Solution<a class="anchor" aria-label="anchor" href="#solution-4"></a>
</h4>
<p><span class="math inline">\(\hat{R}\)</span>的图已经在上面画出来了，都是小于1.2</p>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td align="left">## The homework 8 2021-11-18</td>
</tr>
<tr class="even">
<td align="left">### Question</td>
</tr>
<tr class="odd">
<td align="left">Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</td>
</tr>
<tr class="even">
<td align="left">### Answer</td>
</tr>
<tr class="odd">
<td align="left">#### 11.3</td>
</tr>
<tr class="even">
<td align="left">(a) Write a function to compute the <span class="math inline">\(k^{t h}\)</span> term in <span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^{k}}{k ! 2^{k}} \frac{\|a\|^{2 k+2}}{(2 k+1)(2 k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right) \Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span> where <span class="math inline">\(d \geq 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^{d}\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a \in \mathbb{R}^{d}\)</span> ). (b) Modify the function so that it computes and returns the sum. (c) Evaluate the sum when <span class="math inline">\(a=(1,2)^{T}\)</span>.</td>
</tr>
<tr class="odd">
<td align="left"><span class="math display">\[
取对数：\\
(2k+2)ln(\mid\mid a\mid\mid)+ lgamma(\frac{d+1}{2})+lgamma(k+3/2)-lgamma(k+d/2+1)-\\ln(k!)-kln(2)-ln(2k+1)-ln(2k+2)
\]</span></td>
</tr>
<tr class="even">
<td align="left">```r #计算欧氏距离 Eucdidean &lt;- function(x){ return(sqrt(sum(x*x))) }</td>
</tr>
<tr class="odd">
<td align="left">#计算第k项 fk &lt;- function(a,d,k){ lgfk &lt;- (2<em>k+2)</em>log(Eucdidean(a))+lgamma((d+1)/2)+lgamma(k+3/2)-lgamma(k+d/2+1)-log(factorial(k))-k<em>log(2)-log(2</em>k+1)-log(2<em>k+2) return((-1)^k </em>exp(lgfk)) }</td>
</tr>
<tr class="even">
<td align="left">#计算求和 compute.Sum &lt;- function(Fun,i,j,a1,d1){ #计算函数f的第i到j项 if(i&gt;j){ paste(“范围不对”) } else{ s &lt;- 0 for (r in i:j){ s&lt;- s+Fun(a1,d1,r) } } return(s) }</td>
</tr>
<tr class="odd">
<td align="left">a &lt;- c(1,2) d &lt;- 10</td>
</tr>
<tr class="even">
<td align="left">#计算前100项 compute.Sum(fk,1,100,a,d) #&gt; [1] -0.08562794 #计算前1000项 compute.Sum(fk,1,1000,a,d) #&gt; [1] -0.08562794 ```</td>
</tr>
<tr class="odd">
<td align="left">#### 11.5</td>
</tr>
<tr class="even">
<td align="left">求方程的根</td>
</tr>
<tr class="odd">
<td align="left">
<span class="math display">\[
\begin{gathered}
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\
=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{gathered}
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise <span class="math inline">\(11.4 .\)</span>
</td>
</tr>
<tr class="even">
<td align="left">``` rm(list = ls()) library(knitr)</td>
</tr>
<tr class="odd">
<td align="left">#ck积分上限 ck &lt;- function(a1,k){ if (a1<em>a1&gt;k+1){ paste(“a太大了!”) } else{ return(sqrt((a1^2</em>k)/(k+1-a1*a1))) } }</td>
</tr>
<tr class="even">
<td align="left">#被积函数 fu &lt;- function(u,k){ (1+u*u/k)^(-(k+1)/2) }</td>
</tr>
<tr class="odd">
<td align="left">#传入ck函数 fk &lt;- function(Fun1,Fun2,a1,k1){ #Fun1是 被积函数,Fun2是上界ck coefk &lt;- 2/sqrt(pi<em>k1)</em>exp(lgamma((k1+1)/2)-lgamma(k1/2)) #前面系数部分 res &lt;- integrate(Fun1,lower = 0,upper=Fun2(a1,k1),rel.tol = .Machine<span class="math inline">\(double.eps^0.15,k = k1) #积分部分 return(coefk*res\)</span>value) }</td>
</tr>
<tr class="even">
<td align="left">#k和k-1项相减 dffk &lt;- function(a2,k1){ return(fk(fu,ck,a2,k1)-fk(fu,ck,a2,k1-1)) }</td>
</tr>
<tr class="odd">
<td align="left">#找根 findroot &lt;- function(k1){ m &lt;- 1000 #产生多少个点 #先只在正数部分找，因为是偶函数 a &lt;- seq(-sqrt(k1),sqrt(k1),length.out = m) m &lt;- length(a) jifen &lt;- numeric(m) for (i in 1:m){ jifen[i]&lt;- dffk(a[i],k1) }</td>
</tr>
<tr class="even">
<td align="left">#找零点的区域,有多个零点 lowerbound &lt;- 0-.Machine<span class="math inline">\(double.eps^0.25 upperbound &lt;- 0+.Machine\)</span>double.eps^0.25 for (i in 2:m){ if (jifen[i]*jifen[i-1]&lt;0){ lowerbound &lt;- c(lowerbound,a[i-1]) upperbound &lt;- c(upperbound,a[i]) } } #绘制函数 plot(a,jifen,main = paste(“k=”,k1,“时”),xlab = “a”,ylab = “f(k)-f(k-1)”,type=“l”,xlim = c(min(lowerbound),max(upperbound)))</td>
</tr>
<tr class="odd">
<td align="left">fkroot &lt;- list(root = numeric(length(lowerbound)),f.root = numeric(length(lowerbound))) for ( i in 2:length(lowerbound)){ res &lt;-uniroot(dffk,lower=lowerbound[i],upper = upperbound[i],tol=.Machine<span class="math inline">\(double.eps^0.15,k=k1) fkroot\)</span>root[i] &lt;- res<span class="math inline">\(root fkroot\)</span>f.root[i] &lt;- res<span class="math inline">\(f.root } result &lt;- cbind(fkroot\)</span>root, fkroot$f.root) #合并计算结果 dimnames(result)[[2]] &lt;- c(“root”, “f.toot”) #重命名各列 print(kable(result, caption = paste(“k=”,k1,“时”,“有”,length(lowerbound),“个根”))) #return(fkroot) } ```</td>
</tr>
<tr class="even">
<td align="left"><code>for (i in 4:25){ findroot(i) } findroot(100) findroot(500) findroot(1000)</code></td>
</tr>
<tr class="odd">
<td align="left">#### Supplement</td>
</tr>
<tr class="even">
<td align="left">Suppose <span class="math inline">\(T_{1}, \ldots, T_{n}\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_{i}=T_{i} I\left(T_{i} \leq \tau\right)+\tau I\left(T_{i}&gt;\tau\right)\)</span>, <span class="math inline">\(i=1, \ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_{i}\)</span> values are as follows: <span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_{i}\)</span> follows a mixture distribution).</td>
</tr>
<tr class="odd">
<td align="left"><span class="math display">\[
指数分布:f(x;\lambda) = \frac{1}{\lambda} e^{-\frac{x}{\lambda}}, x,\lambda&gt;0 \\
P(X \leq x;\lambda)= F(x;\lambda) = 1-e^{-\frac{ x}{\lambda}}, x,\lambda&gt;0 \\
则P(X&gt; x;\lambda) = e^{-\frac{x}{\lambda}}, x,\lambda&gt;0 \\
E[x] = \lambda,Var[x] = \lambda^2 \\
寿命分布的无记忆性:\\
P(X&gt;x|X\geq t) = P(X&gt;x-t)I(x\geq t) = e^{-\frac{(x-t)}{\lambda}}I(x\geq t)\\
f(x|X\geq t) = \frac{1}{\lambda} e^{-\frac{(x-t)}{\lambda}}I(x\geq t)\\
P(X&gt;x|X&lt;t) = 1-\frac{F(x;\lambda)}{F(t;\lambda)}=\frac{e^{-\frac{x}{\lambda}}-e^{-\frac{t}{\lambda}}}{1-e^{-\frac{t}{\lambda}}}, \quad 0\leq x\leq t\\
f(x|X&lt;t) = \frac{1}{\lambda} e^{-\frac{x}{\lambda}}I(x&lt;t)
\]</span></td>
</tr>
<tr class="even">
<td align="left">将观察数据分为两部分</td>
</tr>
<tr class="odd">
<td align="left">观测数据<span class="math inline">\(T=\{0.54,0.48,0.33,0.43,0.91,0.21,0.85 \},E=\{E_1,...,E_m\}=\{1,1,1\}\)</span>
</td>
</tr>
<tr class="even">
<td align="left">
<span class="math inline">\(E_i =1\)</span>代表<span class="math inline">\(z_i&gt;\tau\)</span>
</td>
</tr>
<tr class="odd">
<td align="left">隐藏数据<span class="math inline">\(E=\{z_1,z_2,z_3\}\)</span>
</td>
</tr>
<tr class="even">
<td align="left">观测数据的先验分布</td>
</tr>
<tr class="odd">
<td align="left"><span class="math display">\[
\begin{align}
L(Y|\lambda) &amp; = \prod_{j=1}^n \frac{1}{\lambda} e^{-\frac{T_j}{\lambda}}\prod_{k=1}^m P(E_k;\lambda)  \\
&amp;=\frac{1}{\lambda^n}   e^{-\frac{\sum_{j=1}^nT_j}{\lambda}}\prod_{k=1}^m P(E_k;\lambda) \\
参数的先验分布为&amp;无信息先验,\pi(\lambda) = 1 \\
则后验分布为 L(\lambda|Y) &amp;=\frac{1}{\lambda^n}   e^{-\frac{\sum_{j=1}^n T_j}{\lambda}}\prod_{k=1}^m P(E_k;\lambda)   \\
对数先验为\\
l(\lambda|Y) &amp; \propto -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+\sum_{j=1}^{m} ln(P(E_k;\lambda))\\
&amp; \propto -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+\sum_{j=1}^{m} ln(\int _z P(E_k,z;\lambda)dz)\\
\end{align}
\]</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math display">\[
\begin{align}
Q(\lambda,\lambda^{(i)} ) &amp;= -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+\sum_{j=1}^{m} \int_z P(z|E_k;\lambda^{(i)})ln( P(E_k|z;\lambda)P(z;\lambda))dz\\
&amp; = -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+  \sum_{k=1}^{m} \int_{z} \frac{P(z,E_k;\lambda^{(i)})}{P(E_k;\lambda^{(i)})} ln (  P(E_k|z;\lambda))P(z;\lambda)) dz\\
&amp; = -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+  \sum_{k=1}^{m} \int_{z} \frac{P(E_k|z;\lambda^{(i)})P(z;\lambda^{(i)})}{\int_{z} P(E_k|z;\lambda^{(i)})P(z;\lambda^{(i)})dz} ln (  P(E_k|z;\lambda))P(z;\lambda))dz \\
令 \gamma_{ki} &amp;= \frac{P(E_k|z;\lambda^{(i)})P(z;\lambda^{(i)})}{\int_{z} P(E_k|z;\lambda^{(i)})P(z;\lambda^{(i)})dz} \\
则 Q(\lambda,\lambda^{(i)}) &amp;= -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)+\sum_{k=1}^{m} \int_{z} \gamma_{ki}ln (  P(E_k|z;\lambda))P(z;\lambda))dz \\
\end{align}
\]</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math display">\[
P(z;\lambda^{(i)}) = \frac{1}{\lambda^{(i)}}e^{-\frac{z}{\lambda^{(i)}}} \\
P(E_k=1|z;\lambda^{(i)}) = P(z&gt;t;\lambda^{(i)}) = I(z&gt;t) \\
P(E_k=0|z;\lambda^{(i)}) = P(z&lt;t;\lambda^{(i)}) = I(0&lt;z&lt;t) \\
\frac{\partial P(E_k = 1 |z;\lambda)}{\partial \lambda} = 0 \\
\frac{\partial P(E_k = 0 |z;\lambda)}{\partial \lambda} = 0 \\
\frac{\partial P(z;\lambda)}{\partial \lambda} = \frac{1}{\lambda^2}(1-\frac{z}{\lambda}) e^{-\frac{z}{\lambda}} , 0&lt;z&lt;\lambda \\
由于都是大于 t的\\
因此 Q(\lambda,\lambda^{(i)}) = -\frac{\sum_{j=1}^n T_j}{\lambda}-nln(\lambda)-\sum_{k=1}^{m} \int_{z} \gamma_{ki}(\frac{z}{\lambda}+ln(\lambda))dz \\
\frac{1}{P(z;\lambda)}\frac{\partial P(z;\lambda)}{\partial \lambda} =\frac{1}{\lambda}(1-\frac{z}{\lambda}),z&gt;0
\]</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math display">\[
\begin{align}
\frac{\partial Q(\lambda,\lambda^{(i)})}{\partial \lambda} &amp;= \frac{\sum_{j=1}^n T_j}{\lambda^2}-\frac{n}{\lambda}-\sum_{k=1}^{m}\int_z \gamma_{ki}\frac{1}{\lambda}(1-\frac{z}{\lambda})dz \\
&amp; = \frac{\sum_{j=1}^n T_j}{\lambda^2}-\frac{n}{\lambda}-\sum_{k=1}^{m} [\frac{1}{\lambda}\int_z \gamma_{ki}dz-\frac{1}{\lambda^2}\int_z z\gamma_{ki}dz] \\
\int_{t}^{\infty} \gamma_{ki}dz &amp; = e^{-t/\lambda^{(i)}} ,z&gt;t  \\
\int_z z\gamma_{ki}dz &amp; =    \left\{\begin{array}{rcl}
[\lambda^{(i)}-(\lambda^{(i)}+t)e^{-\frac{t}{\lambda^{(i)}}}]/(1-e^{-\frac{t}{\lambda^{(i)}}}),E_k = 0,0&lt;z&lt;t\\
(\lambda^{(i)}+t) ,E_k=1,z&gt;t \\
\end{array}\right. \\
\Rightarrow \frac{\partial Q(\lambda,\lambda^{(i)})}{\partial \lambda} &amp;= \frac{\sum_{j=1}^n T_j}{\lambda^2}-\frac{n}{\lambda} -\frac{m}{\lambda}+\frac{m}{\lambda^2}(\lambda^{(i)}+t) =0 \\
\Rightarrow \lambda^{(i+1)} &amp;= \frac{\sum_{j=1}^n T_j +m(\lambda^{(i)}+t)}{n+m},其中t = 1,m=3,n= 7
\end{align}
\]</span></td>
</tr>
<tr class="odd">
<td align="left">```r T &lt;- c(0.54,0.48,0.33,0.43,0.91,0.21,0.85) E &lt;- c(1,1,1) t &lt;- 1</td>
</tr>
<tr class="even">
<td align="left">EM &lt;- function(T,E,t,max.it = 10000,eps = 1e-6){ n &lt;- length(T) m &lt;- length(E) lambda1 &lt;- 3 lambda2 &lt;-0.5 #初始值 while(abs(lambda1-lambda2)&gt;=eps){ lambda1 &lt;- lambda2 lambda2 &lt;- (sum(T)+m*(lambda1+t))/(n+m) } return(lambda2) } paste(“EM =”,EM(T,E,t,max.it = 10000,eps = 1e-6)) #&gt; [1] “EM = 0.96428546754525” paste(“MLE =”,(sum(T)+sum(E))/length(T)) #&gt; [1] “MLE = 0.964285714285714” ```</td>
</tr>
<tr class="odd">
<td align="left">利用极大似然估计(MLE)</td>
</tr>
<tr class="even">
<td align="left"><span class="math display">\[
\begin{align}
L(Y|\lambda) &amp; = \prod_{i=1}^n \frac{1}{\lambda} e^{-\frac{T_i}{\lambda}}\prod_{k=1}^m P(x_i&gt;t)  \\
&amp;=\frac{1}{\lambda^n}   e^{-\frac{\sum_{i=1}^n T_i}{\lambda}}e^{-\frac{\sum_{j=1}^m t}{\lambda}} \\
参数的先验分布为&amp;无信息先验,\pi(\lambda) = 1 \\
则后验分布为 L(\lambda|Y) &amp;=\frac{1}{\lambda^n}   e^{-\frac{\sum_{i=1}^n T_i}{\lambda}}e^{-\frac{\sum_{j=1}^m E_j}{\lambda}} \\
对数先验为\\
l(\lambda|Y) &amp; \propto -\frac{\sum_{j=1}^m E_j}{\lambda}-\frac{\sum_{i=1}^n T_i}{\lambda}-nln(\lambda)\\
\frac{\partial l(Y|\lambda)}{\partial \lambda} &amp;= \frac{\sum_{j=1}^m E_j+\sum_{i=1}^n T_i}{\lambda^2}-n\frac{1}{\lambda}=0 \\
\Rightarrow \lambda = \frac{\sum_{j=1}^m E_j+\sum_{i=1}^n T_i}{n}
\end{align}
\]</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-homework-9-2021-11-25">The homework 9 2021-11-25<a class="anchor" aria-label="anchor" href="#the-homework-9-2021-11-25"></a>
</h2>
</div>
<div class="section level2">
<h2 id="question-6">Question<a class="anchor" aria-label="anchor" href="#question-6"></a>
</h2>
<p>Exercises 1 and 5 (page 204, Advanced R) Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div class="section level2">
<h2 id="answer-6">Answer<a class="anchor" aria-label="anchor" href="#answer-6"></a>
</h2>
<div class="section level4">
<h4 id="section-12">11.1.2.1<a class="anchor" aria-label="anchor" href="#section-12"></a>
</h4>
<p>Why are the following two invocations of lapply() equivalent?</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12315</span><span class="op">)</span>
<span class="va">trims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">rcauchy</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trims</span>, <span class="kw">function</span><span class="op">(</span><span class="va">trim</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, trim <span class="op">=</span> <span class="va">trim</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] -3.520485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 0.3194412</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.2229875</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.2166389</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trims</span>, <span class="va">mean</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] -3.520485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 0.3194412</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.2229875</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.2166389</span></code></pre></div>
<p>因为<span class="math inline">\(lapply(X,FUN,其他参数)\)</span>是返回一个与X长度相同的列表，飞哥元素都是将函数FUN作用应用于X的响应元素的结果 <span class="math inline">\(mean(x,trim = ,na.rm = FALSE,...)\)</span> 其中x是数值向量，仅仅当<span class="math inline">\(trim=0\)</span>时，复数向量才可以 <span class="math inline">\(trim\)</span>是<span class="math inline">\([0,0.5]\)</span>的比例系数 在计算均值之前，从x的两端去掉观测值的比例<span class="math inline">\((0\sim 0.5)\)</span> 在 <span class="math inline">\(lapply(trims, function(trim) mean(x, trim = trim))\)</span>中 函数<span class="math inline">\(mean\)</span>计算去掉两端trim的比例 ,其实 写成<span class="math inline">\(lapply(trims, function(trim) mean(x, trim))\)</span> 结果是一样的 trim放在mean的参数列表前面，后面就要指定<span class="math inline">\(x=data\)</span>即<span class="math inline">\(mean(trim,x=x)\)</span> trim放在mean的参数列表后面，可以直接写成$mean(x,trim)</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trims</span>, <span class="kw">function</span><span class="op">(</span><span class="va">trim</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">trim</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] -3.520485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 0.3194412</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.2229875</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.2166389</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="section-13">11.1.2.5<a class="anchor" aria-label="anchor" href="#section-13"></a>
</h4>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="at">rsq &lt;- function(mod) summary(mod)$r.squared</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
<span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span>,
<span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">disp</span><span class="op">)</span>,
<span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">wt</span>,
<span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">disp</span><span class="op">)</span> <span class="op">+</span> <span class="va">wt</span>
<span class="op">)</span>

<span class="va">boot_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>
<span class="op">}</span> 

<span class="va">rsq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="op">}</span>

<span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formu</span><span class="op">)</span><span class="op">{</span>
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">boot_df</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>
  <span class="fu">rsq</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">formu</span>,data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#鐢╨apply()</span>NA<span class="co">#lapply(formulas,lm,data = boot_df(mtcars))</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">formulas</span>,<span class="va">boot_lm</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 0.713614</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 0.8332219</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.7862372</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.9033778</span>


<span class="co">#鐢╢or</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">formulas</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">boot_lm</span><span class="op">(</span><span class="va">formulas</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; [1] 0.7077747</span>
<span class="co">#&gt; [1] 0.8725245</span>
<span class="co">#&gt; [1] 0.7980984</span>
<span class="co">#&gt; [1] 0.847342</span>



<span class="co">#鍥犱负鐢ㄤ簡boot_strap鎵€浠ヤ袱涓粨鏋滀笉涓€鏍<b7></b7></span>NA</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bootstraps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
<span class="va">rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, rep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mtcars</span><span class="op">[</span><span class="va">rows</span>, <span class="op">]</span>
<span class="op">}</span><span class="op">)</span>

<span class="va">boot_mpg_disp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">rsq</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">disp</span>,data <span class="op">=</span> <span class="fu">boot_df</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#浣跨敤lapply</span>NA<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">bootstraps</span>, <span class="va">boot_mpg_disp</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 0.6577088</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 0.6720489</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.8279625</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.7219773</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] 0.82747</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; [1] 0.6864452</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[7]]</span>
<span class="co">#&gt; [1] 0.7065602</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[8]]</span>
<span class="co">#&gt; [1] 0.7104219</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[9]]</span>
<span class="co">#&gt; [1] 0.8389606</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[10]]</span>
<span class="co">#&gt; [1] 0.7787436</span>

<span class="co">#浣跨敤for寰幆</span>NA<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bootstraps</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">boot_df</span><span class="op">(</span><span class="va">bootstraps</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">rsq</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">~</span><span class="va">disp</span>,data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; [1] 0.6281573</span>
<span class="co">#&gt; [1] 0.6323042</span>
<span class="co">#&gt; [1] 0.8513368</span>
<span class="co">#&gt; [1] 0.685374</span>
<span class="co">#&gt; [1] 0.7451628</span>
<span class="co">#&gt; [1] 0.5596998</span>
<span class="co">#&gt; [1] 0.6752615</span>
<span class="co">#&gt; [1] 0.6448476</span>
<span class="co">#&gt; [1] 0.7364718</span>
<span class="co">#&gt; [1] 0.7855587</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="section-14">11.2.5.1<a class="anchor" aria-label="anchor" href="#section-14"></a>
</h4>
<p>Use vapply() to: a) Compute the standard deviation of every column in a numeric data frame. b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p>
<ol style="list-style-type: lower-alpha">
<li>
</ol>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">df</span>,<span class="va">sd</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;          x          y </span>
<span class="co">#&gt; 29.0114920  0.9495975</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>
</ol>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">df</span>,<span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">else</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        x        y        z </span>
<span class="co">#&gt; 1.355592       NA 1.032777</span>
<span class="co">#a &lt;- vapply(df, class, character(1)) == "numeric" </span>
<span class="co">#vapply(df,sd,c(1))</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="section-15">11.2.5.7<a class="anchor" aria-label="anchor" href="#section-15"></a>
</h4>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span>
<span class="co">#detectCores鍑芥暟鍙互鍛婅瘔浣犱綘鐨凜PU鍙娇鐢ㄧ殑鏍告暟</span>NA<span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> 

<span class="va">mcsapply</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">Fun</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="co">#cores 鎸囧畾璁＄畻鏍哥殑鏁伴噺</span>NA<span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span>, <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span> 
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mcdummies.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, mc.cores <span class="op">=</span> <span class="va">mc</span><span class="op">)</span>;
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">mcvapply</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">Fun</span>,<span class="va">cha</span>,<span class="va">cores</span> <span class="op">=</span><span class="fl">4</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span>
  <span class="co">#cha鎸囧畾杩斿洖鐨勭被鍨&lt;8b&gt;</span>NA<span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span>, <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span> 
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mcdummies.html" class="external-link">mclapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, mc.cores <span class="op">=</span> <span class="va">mc</span><span class="op">)</span>; 
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu">mcsapply</span><span class="op">(</span><span class="va">df</span>,<span class="va">sd</span><span class="op">)</span></code></pre>
<p>Windows上跑不了mc.cores</p>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td align="left">## The homework 10 2021-12-02</td>
</tr>
<tr class="even">
<td align="left">## Question</td>
</tr>
<tr class="odd">
<td align="left">- Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R). - Compare the corresponding generated random numbers with pure R language using the function <code>qqplot</code>. - Compare the computation time of the two functions with the function <code>microbenchmark</code>. - Comments your results</td>
</tr>
<tr class="even">
<td align="left">## Answer</td>
</tr>
<tr class="odd">
<td align="left">``` rm(list=ls())</td>
</tr>
<tr class="even">
<td align="left">library(Rcpp)</td>
</tr>
<tr class="odd">
<td align="left"># Can create source file in Rstudio</td>
</tr>
<tr class="even">
<td align="left">cppFunction(’NumericMatrix bivariateC(int N,int n,double a,double b,double X0,double Y0) { NumericMatrix X(2,N); NumericVector temp(1); X(0,0) = X0; X(1,0) = Y0; double X1 = 0; double Y1 = 0;</td>
</tr>
<tr class="odd">
<td align="left">for(int i=1;i&lt;=N;i++){ Y1 = X(1,i-1);</td>
</tr>
<tr class="even">
<td align="left">temp = rbinom(1,n,Y1); X(0,i) = temp[0];</td>
</tr>
<tr class="odd">
<td align="left">X1 = X(0,i); temp = rbeta(1,X1+a,n-X1+b); X(1,i) = temp[0]; } return X; } ’)</td>
</tr>
<tr class="even">
<td align="left">N &lt;- 5000 #链的长度 burn &lt;- 1000 #burn-in length</td>
</tr>
<tr class="odd">
<td align="left">###### Mode Parameter ##### n &lt;- 50 a &lt;- 1 b &lt;- 2</td>
</tr>
<tr class="even">
<td align="left">###### 产生链的函数 ##### bivariate.chain &lt;- function(N,n,a,b,X1,Y1){ # N个数据点 参数 n,a,b,初值 X1,Y1 X &lt;- matrix(0,2,N) X[1,1] &lt;- X1 #初始值 X[2,1] &lt;- Y1 for (i in 2:N){ y2 &lt;- X[2,i-1] X[1,i] &lt;- rbinom(1,n,y2) x2 &lt;- X[1,i] X[2,i] &lt;- rbeta(1,x2+a,n-x2+b) } return(X) }</td>
</tr>
<tr class="odd">
<td align="left">X0 &lt;- 1 Y0 &lt;- 0.05</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">``` dataR &lt;- bivariate.chain(N,n,a,b,X0,Y0) dataC &lt;- bivariateC(N,n,a,b,X0,Y0)</td>
</tr>
<tr class="even">
<td align="left">##Plot 分布 plot(dataR[1,],dataR[2,],xlab = “x”,ylab = “y”,main = “Using R”) plot(dataC[1,],dataC[2,],xlab = “x”,ylab = “y”,main = “Using Cpp”) ```</td>
</tr>
<tr class="odd">
<td align="left">``` alist &lt;- ppoints(1000) QRx &lt;- quantile(dataR[1,],alist) QCx &lt;- quantile(dataC[1,],alist) qqplot(QRx,QCx,main=“qqplot for X”,xlab = “X:Using R”,ylab = “Y:Using Cpp”) abline(0,1,col=“red”)</td>
</tr>
<tr class="even">
<td align="left">QRy &lt;- quantile(dataR[2,],alist) QCy &lt;- quantile(dataC[2,],alist) qqplot(QRy,QCy,main=“qqplot for Y”,xlab = “Y:Using R”,ylab = “Y:Using Cpp”) abline(0,1,col=“red”) ```</td>
</tr>
<tr class="odd">
<td align="left"># Test microbenchmark</td>
</tr>
<tr class="even">
<td align="left">
<code>library(microbenchmark) ts &lt;-microbenchmark(bivariate.chain(N,n,a,b,X0,Y0)) summary(ts)[,c(1,3,5,6)] ts &lt;- microbenchmark(bivariateC(N,n,a,b,X0,Y0)) summary(ts)[,c(1,3,5,6)]</code> 我的代码上面不知道为什么会导致<code>R Session Aborted</code>,如果可以你可以帮我运行一下 我自己写了一个测试函数运行时间的代码 结果显示在R和Rcpp生成的分布差不多，但是Rcpp明显计算快了非常多</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rongkang Xiong.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
